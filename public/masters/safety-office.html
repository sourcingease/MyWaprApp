<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Safety Officer Dashboard ‚Ä¢ ComplytEX</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="stylesheet" href="/app.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f5f7fa;
      color: #1e293b;
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Navigation */
    .sidebar {
      width: 250px;
      background: white;
      border-right: 1px solid #e2e8f0;
      padding: 20px 0;
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      overflow-y: auto;
      transform: translateX(-250px);
      transition: transform 0.3s ease;
      z-index: 1000;
    }

    .sidebar.open {
      transform: translateX(0);
    }

    .sidebar-logo {
      padding: 0 20px 20px;
      border-bottom: 1px solid #e2e8f0;
      margin-bottom: 20px;
    }

    .sidebar-logo img {
      max-width: 100%;
      height: auto;
    }

    .nav-menu {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .nav-item {
      margin: 0;
    }

    .nav-link {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: #64748b;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
      border-left: 3px solid transparent;
    }

    .nav-link:hover {
      background: #f8fafc;
      color: #0ea5e9;
      border-left-color: #0ea5e9;
    }

    .nav-link.active {
      background: #f0f9ff;
      color: #0ea5e9;
      border-left-color: #0ea5e9;
      font-weight: 600;
    }

    .nav-icon {
      font-size: 18px;
      margin-right: 12px;
      width: 24px;
      text-align: center;
    }

    /* Main Content Area */
    .main-content {
      flex: 1;
      margin-left: 0;
      padding: 20px;
      width: 100%;
      transition: margin-left 0.3s ease;
    }

    /* Sidebar Toggle Button */
    .sidebar-toggle {
      position: fixed;
      left: 10px;
      top: 10px;
      width: 40px;
      height: 40px;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      z-index: 1001;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.2s;
    }

    .sidebar-toggle:hover {
      background: #f8fafc;
      border-color: #0ea5e9;
      color: #0ea5e9;
    }

    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: none;
      z-index: 999;
    }

    .sidebar-overlay.active {
      display: block;
    }

    /* Generic modal overlay (used by Plan New Audit) */
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,.5); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 10px; }
    .overlay.open { display: flex; }
    .modal { background: #fff; border-radius: 12px; border: 1px solid #e2e8f0; max-width: 880px; width: 100%; max-height: 86vh; overflow: auto; box-shadow: 0 10px 30px rgba(0,0,0,.2); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-bottom: 1px solid #e2e8f0; }
    .modal-body { padding: 16px; }
    /* Modal form overrides */
    .audit-form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .audit-form-grid .form-group label { font-size: 13px; color: #475569; }
    .audit-form-grid .form-group input, .audit-form-grid .form-group select, .audit-form-grid .form-group textarea { width: 100%; padding: 10px 12px; border: 1px solid #e2e8f0; border-radius: 8px; font: inherit; }
    .audit-form-grid select[multiple] { min-height: 140px; }
    .audit-modal-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 12px; }
    @media (max-width: 900px){ .modal{ max-width: 96%; } }
    @media (max-width: 768px){ .audit-form-grid{ grid-template-columns: 1fr; } }

    /* Compact buttons for toolbar */
    .btn-compact{ padding:6px 10px; font-size:12px; line-height:16px; height:32px; border-radius:8px; font-weight:600 }
    .btn-100{ width:100px; min-width:100px; max-width:100px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }

    /* Header */
    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
      padding: 16px 24px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border-bottom: 3px solid #0ea5e9;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .logo-small {
      max-height: 40px;
      width: auto;
    }

    .dashboard-title {
      font-size: 20px;
      font-weight: 700;
      color: #0f172a;
      letter-spacing: -0.025em;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
      position: relative; /* for user dropdown positioning */
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      background: #d1fae5;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
      color: #065f46;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      background: #10b981;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(0.95); }
    }

    .user-badge {
      width: 36px;
      height: 36px;
      background: #0ea5e9;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(14,165,233,0.25);
    }

    /* User dropdown menu */
    .user-menu {
      position: absolute;
      right: 0;
      top: 100%;
      margin-top: 8px;
      width: 280px;
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      box-shadow: 0 12px 24px rgba(0,0,0,0.12);
      display: none;
      z-index: 1100;
    }
    .user-menu.open { display: block; }
    .user-menu .menu-header { display: flex; gap: 12px; align-items: center; padding: 12px 16px; border-bottom: 1px solid #e2e8f0; }
    .user-menu .avatar { width: 56px; height: 56px; background: #e2e8f0; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; color: #334155; }
    .user-menu .name { font-weight: 700; color:#0f172a; }
    .user-menu .role { font-size: 12px; color: #64748b; }
    .user-menu .company { font-size: 12px; color: #94a3b8; }
    .user-menu .menu-item { padding: 12px 16px; cursor: pointer; display: flex; align-items: center; gap: 8px; color: #0f172a; text-decoration:none; }
    .user-menu .menu-item:hover { background: #f8fafc; }
    .user-menu .menu-actions { padding: 12px 16px; display: flex; gap: 8px; border-top: 1px solid #e2e8f0; justify-content: flex-end; }
    .user-menu .btn { padding: 8px 12px; border-radius: 8px; font-weight: 600; font-size: 12px; border: 1px solid #e2e8f0; background: #ffffff; cursor: pointer; }
    .user-menu .btn.primary { background: #ef4444; color: white; border-color: #ef4444; }

    .icon-btn {
      width: 36px;
      height: 36px;
      background: transparent;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      color: #64748b;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      font-size: 18px;
    }

    .icon-btn:hover {
      background: #f1f5f9;
      border-color: #0ea5e9;
      color: #0ea5e9;
    }

    .audit-btn {
      padding: 8px 16px;
      background: linear-gradient(135deg, #0ea5e9, #0284c7);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
    }

    .audit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4);
    }

    /* Tabs Navigation */
    .tabs-container {
      /* Legacy horizontal text tabs (Incidents, Grievances, USC-Safe, etc.)
         are no longer used; keep markup but always hide this container. */
      display: none !important;
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 24px;
      overflow: hidden;
    }

    .tabs-nav {
      display: flex;
      border-bottom: 2px solid #f1f5f9;
      overflow-x: hidden;
      flex-wrap: wrap;
    }

    .tab-item {
      flex: 0 1 auto;
      min-width: 80px;
      padding: 8px 12px;
      background: white;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 11px;
      font-weight: 600;
      color: #64748b;
      transition: all 0.3s;
      text-align: center;
      white-space: nowrap;
    }

    .tab-item:hover {
      background: #f8fafc;
      color: #0ea5e9;
    }

    .tab-item.active {
      color: #0ea5e9;
      background: #f0f9ff;
      border-bottom-color: #0ea5e9;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
      min-height: 500px;
      overflow-y: hidden;
    }

    /* Main Content */
    .dashboard-content {
      display: grid;
      grid-template-columns: 1fr 4fr 1fr; /* 1/6 left, 4/6 center, 1/6 right */
      gap: 20px;
      margin-bottom: 20px;
      align-items: start;
    }

    /* Column placement */
    .safety-pane { grid-column: 1; grid-row: 1; align-self: start; padding: 8px; }
    .working-pane { grid-column: 2; grid-row: 1; min-height: 520px; }
    .proc-pane { grid-column: 3; grid-row: 1; align-self: start; }

    /* Top horizontal safety icon bar (Incidents, Grievances, USC-Safe, etc.) */
    .top-safety-tabs {
      width: 100%;
      margin: 4px 0 6px 0;
      display: flex;
      gap: 6px;
      justify-content: center;
      align-items: flex-start;
      padding: 4px 6px;
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      overflow-x: auto;
    }
    .top-safety-tabs .sm-tab {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      background: transparent;
      border: none;
      padding: 0;
      cursor: pointer;
    }
    .top-safety-tabs .sm-icon-box {
      width: 28px;
      height: 28px;
      border: 1px solid #e2e8f0;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
    }
    .top-safety-tabs .sm-icon-box:hover {
      border-color: #0ea5e9;
      background: #f8fafc;
    }
    .top-safety-tabs .sm-ico {
      font-size: 14px;
      line-height: 14px;
    }
    .top-safety-tabs .sm-lbl {
      font-size: 10px;
      line-height: 1;
      color: #64748b;
      white-space: nowrap;
      text-align: center;
    }
    .top-safety-tabs .sm-tab.active .sm-icon-box {
      border-color: #0ea5e9;
      background: #eff6ff;
    }

    /* Hide incidents from center for empty workspace */
    .incidents-card { display: none; }

    /* Cards */
    .dashboard-card {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .card-header {
      font-size: 16px;
      font-weight: 600;
      color: #0f172a;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #f1f5f9;
    }

    /* Procurement Status */
    .status-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      margin-bottom: 10px;
      background: #f8fafc;
      border-radius: 10px;
      transition: all 0.2s;
      cursor: pointer;
    }

    .status-item:hover {
      background: #f1f5f9;
      transform: translateX(4px);
    }

    .status-label {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      color: #475569;
      font-weight: 500;
    }

    .status-dot-indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .status-count {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 36px;
      height: 36px;
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-weight: 700;
      color: #0f172a;
      font-size: 16px;
    }

    /* Incident Reports */
    .incident-item {
      padding: 16px;
      margin-bottom: 12px;
      background: #f8fafc;
      border-radius: 10px;
      border-left: 4px solid #0ea5e9;
      cursor: pointer;
      transition: all 0.2s;
    }

    .incident-item:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: translateY(-2px);
    }

    .incident-title {
      font-size: 14px;
      font-weight: 600;
      color: #0ea5e9;
      margin-bottom: 6px;
    }

    .incident-description {
      font-size: 13px;
      color: #64748b;
      margin-bottom: 10px;
      line-height: 1.5;
    }

    .incident-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .incident-status {
      display: inline-block;
      padding: 4px 12px;
      background: #fef2f2;
      color: #dc2626;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
    }

    .incident-status.closed {
      background: #dcfce7;
      color: #16a34a;
    }

    .incident-status.review {
      background: #fef3c7;
      color: #f59e0b;
    }

    .view-link {
      color: #0ea5e9;
      font-size: 13px;
      font-weight: 500;
      text-decoration: none;
    }

    .view-link:hover {
      text-decoration: underline;
    }

    /* Action Buttons */
    .action-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
    }

    .action-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 24px 16px;
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      color: #1e293b;
    }

    .action-btn:hover {
      border-color: #0ea5e9;
      box-shadow: 0 8px 16px rgba(14, 165, 233, 0.15);
      transform: translateY(-4px);
    }

    .action-icon {
      font-size: 36px;
    }

    .action-label {
      font-size: 13px;
      font-weight: 600;
      text-align: center;
    }

    /* Safety pane compact overrides: exactly two per row, small icons and labels */
    .safety-pane .action-buttons { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
    .safety-pane .action-btn {
      width: 100% !important;
      height: 68px !important;
      min-height: 68px !important;
      padding: 6px !important;
      gap: 4px !important;
      border: 2px solid #e2e8f0 !important;
      border-radius: 4px !important;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: #fff !important;
    }
    .safety-pane .action-icon {
      font-size: 15px !important;
      width: 15px !important;
      height: 15px !important;
      line-height: 15px !important;
      display: inline-block;
    }
    .safety-pane .action-label {
      display: block;
      margin-top: 2px !important;
      font-size: 7px !important;
      line-height: 1 !important;
      text-align: center;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
      max-width: 100% !important;
    }

    /* Hide safety icons in left panel; keep top bar */
    .safety-pane .action-buttons { display: none !important; }
    .dashboard-card.safety-pane { padding: 16px !important; display:flex; flex-direction:column; }
    .safety-pane .agent-box{ display:flex; align-items:center; gap:10px; padding:10px; background:#f8fafc; border:1px solid #e2e8f0; border-radius:8px }
    .safety-pane .agent-ico{ width:28px; height:28px; border:1px solid #e2e8f0; border-radius:8px; display:flex; align-items:center; justify-content:center; background:#fff }
    .safety-pane .agent-title{ font-weight:700; color:#0f172a; }
    .safety-pane .agent-sub{ font-size:12px; color:#64748b }

    /* Accounting top tabs (in working area) */
    .acct-top-tabs{ width:100%; margin:4px 0 8px 0; display:flex; gap:6px; justify-content:flex-start; align-items:flex-start; padding:4px; background:#fff; border:1px solid #e2e8f0; border-radius:6px; overflow-x:auto; }
    .acct-top-tabs .sm-tab{ display:flex; flex-direction:column; align-items:center; gap:1px; background:transparent; border:none; padding:0; cursor:pointer; text-decoration:none; color:#0f172a }
    .acct-top-tabs .sm-icon-box{ width:30px; height:30px; border:1px solid #e2e8f0; border-radius:6px; display:flex; align-items:center; justify-content:center; background:#fff }
    .acct-top-tabs .sm-icon-box:hover{ border-color:#0ea5e9; background:#f8fafc }
    .acct-top-tabs .sm-ico{ font-size:15px; line-height:15px }
    .acct-top-tabs .sm-lbl{ font-size:10px; line-height:1; color:#64748b; white-space:nowrap; text-align:center; }

    /* Charts */
    .chart-container {
      position: relative;
      height: 200px;
      margin-top: 16px;
    }

    /* Full Width Section */
    .full-width-card {
      grid-column: 1 / -1;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .action-buttons {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    @media (max-width: 968px) {
      .dashboard-content {
        grid-template-columns: 1fr;
      }

      .action-buttons {
        grid-template-columns: repeat(2, 1fr);
      }

      .dashboard-header {
        flex-direction: column;
        gap: 16px;
      }

      .header-right {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
      }
    }

    @media (max-width: 640px) {
      .action-buttons {
        grid-template-columns: 1fr;
      }
    }

    /* Form Styles */
    .form-container {
      background: #f8fafc;
      padding: 24px;
      border-radius: 12px;
      margin-bottom: 24px;
      border: 2px solid #e2e8f0;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-group label {
      font-size: 14px;
      font-weight: 600;
      color: #0f172a;
      margin-bottom: 8px;
    }

    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group input[type="datetime-local"],
    .form-group select,
    .form-group textarea {
      padding: 10px 14px;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      transition: all 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #0ea5e9;
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
    }

    .radio-group {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    .radio-group label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 500;
      cursor: pointer;
    }

    .radio-group input[type="radio"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .form-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-start;
      margin-top: 24px;
    }

    /* Action Buttons */
    .action-button {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .save-btn {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    .save-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }

    .reset-btn {
      background: #f1f5f9;
      color: #64748b;
      border: 1px solid #e2e8f0;
    }

    .reset-btn:hover {
      background: #e2e8f0;
      color: #475569;
    }

    .cancel-btn {
      background: #fee2e2;
      color: #dc2626;
    }

    .cancel-btn:hover {
      background: #fecaca;
    }

    .add-btn {
      background: linear-gradient(135deg, #0ea5e9, #0284c7);
      color: white;
      box-shadow: 0 2px 8px rgba(14, 165, 233, 0.3);
    }

    .add-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(14, 165, 233, 0.4);
    }

    .export-btn {
      background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      color: white;
      box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);
    }

    .export-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
    }

    .back-btn {
      background: white;
      color: #64748b;
      border: 1px solid #e2e8f0;
    }

    .back-btn:hover {
      background: #f8fafc;
      border-color: #0ea5e9;
      color: #0ea5e9;
    }

    /* Data Table */
    .data-table-container {
      overflow-x: auto;
      margin-top: 20px;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    .data-table thead {
      background: #f8fafc;
      border-bottom: 2px solid #e2e8f0;
    }

    .data-table th {
      padding: 12px 16px;
      text-align: left;
      font-size: 13px;
      font-weight: 600;
      color: #475569;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .data-table td {
      padding: 12px 16px;
      border-bottom: 1px solid #f1f5f9;
      font-size: 14px;
      color: #1e293b;
    }

    .data-table tbody tr:hover {
      background: #f8fafc;
    }

    .table-action-btn {
      padding: 6px 12px;
      margin: 0 4px;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-edit {
      background: #dbeafe;
      color: #0ea5e9;
    }

    .btn-edit:hover {
      background: #bfdbfe;
    }

    .btn-delete {
      background: #fee2e2;
      color: #dc2626;
    }

    .btn-delete:hover {
      background: #fecaca;
    }

    .status-badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      display: inline-block;
    }

    .status-open {
      background: #fef3c7;
      color: #f59e0b;
    }

    .status-closed {
      background: #dcfce7;
      color: #16a34a;
    }

    .status-pending {
      background: #fef3c7;
      color: #f59e0b;
    }

    .status-review {
      background: #dbeafe;
      color: #0ea5e9;
    }

    @media (max-width: 968px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .sidebar {
        transform: translateX(-250px);
      }
    }
</style>
</head>
<body>
  <script>
    (function(){
      function hideIfEmbedded(){
        const p=new URLSearchParams(location.search);
        if(p.get('embedded')==='1'){
          const hdr=document.querySelector('.dashboard-header'); if(hdr) hdr.remove();
          const proc=document.querySelector('.proc-pane'); if(proc) proc.style.display='none';
        }
      }
      if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', hideIfEmbedded); else hideIfEmbedded();
    })();
  </script>
  <!-- i18n disabled -->
  <script src="/js/master-layout.js"></script>
  <script src="/js/agents-ui.js"></script>
  <!-- Sidebar Toggle Button -->
  <button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>
  
  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
  
  <div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-logo">
        <img src="/logo.png" alt="ComplytEX">
      </div>
      <nav>
        <ul class="nav-menu">
          <li class="nav-item">
            <a href="#" class="nav-link active" onclick="switchTab('overview'); return false;">
              <span class="nav-icon">üè†</span>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('incidents'); return false;">
              <span class="nav-icon">üö®</span>
              <span>Incidents</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('grievances'); return false;">
              <span class="nav-icon">üìã</span>
              <span>Grievances</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('usc-safe'); return false;">
              <span class="nav-icon">üìã</span>
              <span>USC-Safe</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('fire'); return false;">
              <span class="nav-icon">üî•</span>
              <span>Fire Safety</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('electrical'); return false;">
              <span class="nav-icon">‚ö°</span>
              <span>Electrical</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('structural'); return false;">
              <span class="nav-icon">üèóÔ∏è</span>
              <span>Structural</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('health'); return false;">
              <span class="nav-icon">‚ö†Ô∏è</span>
              <span>Health Hazards</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('gas'); return false;">
              <span class="nav-icon">üî•</span>
              <span>Gas Safety</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('boiler'); return false;">
              <span class="nav-icon">‚öôÔ∏è</span>
              <span>Boiler Safety</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('consultant'); return false;">
              <span class="nav-icon">üíº</span>
              <span>Consultant Engagement</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('dsa'); return false;">
              <span class="nav-icon">üèõÔ∏è</span>
              <span>DSA</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link" onclick="switchTab('emergency-power'); return false;">
              <span class="nav-icon">üîå</span>
              <span>Emergency Power</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
    <!-- Header -->
    <div class="dashboard-header">
      <div class="header-left">
        <img src="/logo.png" alt="ComplytEX" class="logo-small">
        <div>
          <h1 class="dashboard-title" data-i18n="safety.officer.dashboard">SAFETY OFFICER DASHBOARD</h1>
        </div>
      </div>
      <div class="header-right">
        <div class="status-indicator">
          <span class="status-dot"></span>
          Online
        </div>
        <a href="#" onclick="goToDashboard(); return false;" style="font-size: 13px; color: #64748b; font-weight: 500; text-decoration: none;">My Dashboard</a>
        <!-- Icons and user dropdown are injected globally by /js/master-layout.js to ensure consistency -->
      </div>
    </div>

    <!-- Tabs Navigation (hidden for overview) -->
    <div class="tabs-container" id="tabs-navigation" style="display: none;">
      <div class="tabs-nav">
        <button class="tab-item" data-tab="incidents">Incidents</button>
        <button class="tab-item" data-tab="grievances">Grievances</button>
        <button class="tab-item" data-tab="usc-safe">USC-Safe</button>
        <button class="tab-item" data-tab="fire">Fire Safety</button>
        <button class="tab-item" data-tab="electrical">Electrical</button>
        <button class="tab-item" data-tab="structural">Structural</button>
        <button class="tab-item" data-tab="health">Health Hazards</button>
        <button class="tab-item" data-tab="gas">Gas Safety</button>
        <button class="tab-item" data-tab="boiler">Boiler Safety</button>
        <button class="tab-item" data-tab="consultant">Consultant Engagement</button>
        <button class="tab-item" data-tab="dsa">DSA</button>
        <button class="tab-item" data-tab="emergency-power">Emergency Power</button>
      </div>
    </div>

    <!-- Tab Content -->
    <div id="tab-overview" class="tab-content active">
      <!-- Overview Tab Content -->
      <div class="dashboard-content">
      <!-- Procurement Status (moves to right) -->
      <div class="dashboard-card proc-pane">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div class="card-header" style="margin:0">Procurement Status</div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot-indicator" style="background: #f59e0b;"></span>
            Pending RFQs
          </div>
          <div class="status-count">0</div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot-indicator" style="background: #3b82f6;"></span>
            Quotes Received
          </div>
          <div class="status-count">0</div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot-indicator" style="background: #8b5cf6;"></span>
            Orders Approved
          </div>
          <div class="status-count">0</div>
        </div>
        <div class="status-item">
          <div class="status-label">
            <span class="status-dot-indicator" style="background: #10b981;"></span>
            Materials Delivered
          </div>
          <div class="status-count">0</div>
        </div>
      </div>

      <!-- Recent Incident Reports (hidden, workspace left empty) -->
      <div class="dashboard-card incidents-card">
        <div class="card-header">Recent Incident Reports</div>
        <div class="incident-item">
          <div class="incident-title">Machinery Incident at Production Floor - Line 3</div>
          <div class="incident-description">Minor cut on hand from exposed sharp edge on weaving machine.</div>
          <div class="incident-footer">
            <span class="incident-status">Open</span>
            <a href="#" class="view-link">View</a>
          </div>
        </div>
        <div class="incident-item" style="border-left-color: #10b981;">
          <div class="incident-title">Electrical Safety Inspection - Building A</div>
          <div class="incident-description">Annual electrical safety inspection completed successfully.</div>
          <div class="incident-footer">
            <span class="incident-status closed">Closed</span>
            <a href="#" class="view-link">View</a>
          </div>
        </div>
        <div class="incident-item" style="border-left-color: #f59e0b;">
          <div class="incident-title">Fire Drill Compliance Check</div>
          <div class="incident-description">Monthly fire drill conducted. Minor timing issues noted.</div>
          <div class="incident-footer">
            <span class="incident-status review">Review</span>
            <a href="#" class="view-link">View</a>
          </div>
        </div>
      </div>

      <!-- Safety Tabs (moves to left) -->
      <div class="dashboard-card safety-pane">
        <div id="safety-agents-panel" style="margin-bottom:8px;"></div>
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div class="card-header" style="margin:0">Safety</div>
        </div>
        <div class="agent-box" style="margin-top:8px; cursor:pointer;" onclick="showSafetyAgent(); return false;">
          <div class="agent-ico">üõ°Ô∏è</div>
          <div class="agent-text">
            <div class="agent-title">Safety Agent</div>
            <div class="agent-sub">Upload docs or type queries. All writes require approval.</div>
          </div>
        </div>
        <!-- Restored compact Safety Tabs for left panel; also used to build the top bar -->
        <div class="action-buttons" style="margin-top:12px;">
          <a class="action-btn" href="#" onclick="switchTab('incidents'); return false;"><div class="action-icon">üö®</div><div class="action-label">Incidents</div></a>
          <a class="action-btn" href="#" onclick="switchTab('grievances'); return false;"><div class="action-icon">üìã</div><div class="action-label">Grievances</div></a>
          <a class="action-btn" href="#" onclick="switchTab('usc-safe'); return false;"><div class="action-icon">üìë</div><div class="action-label">USC-Safe</div></a>
          <a class="action-btn" href="#" onclick="switchTab('fire'); return false;"><div class="action-icon">üî•</div><div class="action-label">Fire</div></a>
          <a class="action-btn" href="#" onclick="switchTab('electrical'); return false;"><div class="action-icon">‚ö°</div><div class="action-label">Electrical</div></a>
          <a class="action-btn" href="#" onclick="switchTab('structural'); return false;"><div class="action-icon">üèóÔ∏è</div><div class="action-label">Structural</div></a>
          <a class="action-btn" href="#" onclick="switchTab('health'); return false;"><div class="action-icon">‚öïÔ∏è</div><div class="action-label">Health</div></a>
          <a class="action-btn" href="#" onclick="switchTab('gas'); return false;"><div class="action-icon">üßØ</div><div class="action-label">Gas</div></a>
          <a class="action-btn" href="#" onclick="switchTab('boiler'); return false;"><div class="action-icon">‚öôÔ∏è</div><div class="action-label">Boiler</div></a>
          <a class="action-btn" href="#" onclick="switchTab('consultant'); return false;"><div class="action-icon">üíº</div><div class="action-label">Consultant</div></a>
          <a class="action-btn" href="#" onclick="switchTab('dsa'); return false;"><div class="action-icon">üèõÔ∏è</div><div class="action-label">DSA</div></a>
          <a class="action-btn" href="#" onclick="switchTab('emergency-power'); return false;"><div class="action-icon">üîå</div><div class="action-label">Emergency</div></a>
          <a class="action-btn" href="#" onclick="showAuditList(); return false;"><div class="action-icon">üßæ</div><div class="action-label">Audits</div></a>
          <a class="action-btn" href="/training.html"><div class="action-icon">üéì</div><div class="action-label">Training</div></a>
          <a class="action-btn" href="#" onclick="showSafetyAgent(); return false;"><div class="action-icon">üõ°Ô∏è</div><div class="action-label">Agent</div></a>
        </div>
      </div>

      <!-- Working area placeholder (center 4/6) -->
      <div class="dashboard-card working-pane" style="border: 2px dashed #e2e8f0; background: #fff; color: #94a3b8;">
        <div>Working area</div>
      </div>

      <script>

        function showTasks(){
          try{
            const pane = document.querySelector('.working-pane'); if(!pane) return;
            pane.style.display='block'; pane.style.alignItems='stretch'; pane.style.justifyContent='flex-start'; pane.style.padding='0';
            pane.innerHTML = `<div style="padding:0; height:calc(86vh); display:flex; flex-direction:column"><iframe src="/tasks/planning.html?embedded=1" style="border:0; width:100%; height:100%"></iframe></div>`;
          }catch(e){ console.warn('showTasks failed', e); }
        }

        async function showAuditList(){
          const pane = document.querySelector('.working-pane');
          if(!pane) return;
          // Align to top, full padding for content
          pane.style.display = 'block';
          pane.style.alignItems = 'stretch';
          pane.style.justifyContent = 'flex-start';
          pane.style.padding = '0';

          // UI: header + actions + table + modal container
          pane.innerHTML = `
            <div style="padding:14px 16px;">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:8px;">
                <div style="font-size:22px;font-weight:800;letter-spacing:-0.02em">SAFETY AUDITS</div>
                <div style="display:flex;gap:8px;align-items:center;flex:1;justify-content:flex-end;">
                  <input id="auditSearch" placeholder="Search by name, type, or status..." style="flex:1 1 260px;max-width:420px;padding:10px 12px;border:1px solid #e2e8f0;border-radius:8px;font:inherit">
                  <button id=\"btnPlanAudit\" class=\"audit-btn btn-compact btn-100\" style=\"background:#0891b2\" title=\"Plan New Audit\">‚äï Plan</button>
                  <button id="btnExportExcel" class="action-button export-btn btn-compact btn-100" title="Export to Excel">Excel</button>
                  <button id=\"btnExportPDF\" class=\"action-button btn-compact btn-100\" style=\"background:#475569;color:#fff\" title=\"Export to PDF\">PDF</button>
                </div>
              </div>

              <div class="data-table-container">
                <table class="data-table" id="auditsTable">
                  <thead>
                    <tr>
                      <th data-sort="AuditDate" style="cursor:pointer">Audit Date <span id="adSort">‚ñº</span></th>
                      <th data-sort="AuditName" style="cursor:pointer">Audit Name</th>
                      <th data-sort="AuditType" style="cursor:pointer">Related To</th>
                      <th data-sort="Status" style="cursor:pointer">Status</th>
                      <th>Action</th>
                      <th>Certificate</th>
                    </tr>
                  </thead>
                  <tbody id="auditTableBody">
                    <tr><td colspan="6" style="text-align:center; padding:16px; color:#94a3b8;">Loading...</td></tr>
                  </tbody>
                </table>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;margin-top:8px;">
                <div id="auditCount" class="muted" style="font-size:12px"></div>
                <div style="display:flex;align-items:center;gap:8px;">
                  <button id="auditPrev" class="ct" type="button">Prev</button>
                  <span id="auditPageInfo" class="muted" style="font-size:12px">Page 1 of 1</span>
                  <button id="auditNext" class="ct" type="button">Next</button>
                </div>
              </div>
            </div>
            <div id="auditModal" class="overlay">
              <div class="modal">
                <div class="modal-header">
                  <div style="font-weight:700">Plan New Audit</div>
                  <button class="action-button back-btn" id="closeAuditModal">Close</button>
                </div>
                <div class="modal-body">
                  <div class="audit-form-grid">
                    <div class="form-group">
                      <label>Audit Name</label>
                      <input id="paName" placeholder="e.g. Q3 Fire Safety Review">
                    </div>
                    <div class="form-group">
                      <label>Audit Type(s)</label>
                      <select id="paType" multiple size="10">
                        <option>USC-Safe</option>
                        <option>Fire</option>
                        <option>Electrical</option>
                        <option>Structural</option>
                        <option>Health</option>
                        <option>Gas</option>
                        <option>Boiler</option>
                        <option>Consultant Engagement</option>
                        <option>DSA</option>
                        <option>Emergency Power</option>
                      </select>
                      <div class="muted" style="margin-top:4px">Hold Ctrl/‚åò to select multiple</div>
                    </div>
                    <div class="form-group">
                      <label>Audit Company</label>
                      <input id="paCompany" placeholder="e.g. SafeCert Ltd">
                    </div>
                    <div class="form-group">
                      <label>Audit Date</label>
                      <input id="paDate" type="date">
                    </div>
                  </div>
                  <div class="audit-modal-actions">
                    <button class="action-button back-btn" id="paCancel">Cancel</button>
                    <button class="action-button save-btn" id="paSave">Save</button>
                  </div>
                </div>
              </div>
            </div>`;

          // Resolve tenant for SAAS
          let tenantId = 1;
          try {
            const r = await fetch('/api/auth/me', { credentials: 'include' });
            const j = await r.json();
            if (j && j.data && j.data.tenantId) tenantId = j.data.tenantId;
          } catch(e) {}

          let _audits = [];
          let _sortField = 'AuditDate';
          let _sortDir = 'desc';
          let _page = 1;
          const PAGE_SIZE = 10;
          const tbody = document.getElementById('auditTableBody');

          function pill(status){
            if(status==='Closed') return '<span class="status-badge status-closed">CLOSED</span>';
            if(status==='OpenIssues') return '<span class="status-badge status-open">PENDING CORRECTION</span>';
            return '<span class="status-badge status-review">NEW</span>';
          }

          // Build checklist items for a new audit by reading the latest master
          // safety forms (Fire, USC-Safe, Electrical, etc.) from the database.
          // This way, when you change answers in the master checklist tabs,
          // the next planned audit will use the updated Yes/No/N/A values,
          // while previous audits keep their own snapshot.

          function buildItemsFromChecklistForm(formRef, formDataObject){
            // formRef can be a string ID or an actual <form> element.
            const form = typeof formRef === 'string'
              ? document.getElementById(formRef)
              : formRef;
            const items = [];
            if(!form || !formDataObject || typeof formDataObject !== 'object') return items;

            // Use DOM order of radio groups so the audit list matches the on-screen checklist
            const seenNames = new Set();
            const radios = form.querySelectorAll('input[type="radio"]');
            radios.forEach(r => {
              const name = r.name;
              if(!name || seenNames.has(name)) return;
              seenNames.add(name);

              // Friendly field label (fallback to name if we cannot resolve the question text)
              let labelText = name;

              // Structure used by USC-Safe / Fire Safety tabs:
              // <label>
              //   <span>Question text</span>
              //   <div class="radio-group">
              //     <label><input type="radio" ...> Yes</label>
              //     ...
              //   </div>
              // </label>
              const group = r.closest('.radio-group');
              if(group && group.previousElementSibling && group.previousElementSibling.tagName === 'SPAN'){
                const span = group.previousElementSibling;
                if(span.textContent && span.textContent.trim()){
                  labelText = span.textContent.trim();
                }
              } else {
                // Fallback: look for the nearest label and use its text (older forms)
                const outerLabel = r.closest('label');
                if(outerLabel && outerLabel.textContent.trim()){
                  labelText = outerLabel.textContent.trim();
                }
              }

              const valueRaw = Object.prototype.hasOwnProperty.call(formDataObject, name)
                ? formDataObject[name]
                : null;
              const value = (valueRaw === 'Yes' || valueRaw === 'No' || valueRaw === 'N/A')
                ? valueRaw
                : 'N/A';

              // VERY IMPORTANT: NoIssue must stay null at plan time so that the
              // audit remains in Planned status and Compliance shows as Pending.
              items.push({
                Head: labelText,
                Value: value,
                NoIssue: null,
                IssueDetails: null,
                Attachments: null,
                SuggestedAction: null,
                InformedTo: null
              });
            });
            return items;
          }

          async function buildItemsForAuditTypes(typeStr){
            const out = [];
            if(!window.SafetyAPI || !typeStr) return out;
            const key = typeStr.toString().toLowerCase();

            try{
              if(key.includes('fire')){
                const data = await window.SafetyAPI.loadFireSafety();
                if(data && !Array.isArray(data)){
                  // Try to locate whichever Fire Safety checklist form is present
                  // on the Safety Officer dashboard so that we can reuse the
                  // exact question text and the current Yes/No/N/A answers.
                  const fireFormEl = document.getElementById('fireFormData')
                    || document.getElementById('fire-safety-form')
                    || document.querySelector('#tab-fire form, #fire-safety form, #fire-form form');
                  if(fireFormEl){
                    out.push(...buildItemsFromChecklistForm(fireFormEl, data));
                  }
                }
              }
            }catch(e){ console.warn('Failed to load Fire Safety template for audit seeding', e); }

            try{
              if(key.includes('usc-safe')){
                const data = await window.SafetyAPI.loadUSCSafe();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('uscSafeFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load USC-Safe template for audit seeding', e); }

            try{
              if(key.includes('electrical')){
                const data = await window.SafetyAPI.loadElectricalSafety();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('electricalFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Electrical Safety template for audit seeding', e); }

            try{
              if(key.includes('structural')){
                const data = await window.SafetyAPI.loadStructuralSafety();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('structuralFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Structural Safety template for audit seeding', e); }

            try{
              if(key.includes('health')){
                const data = await window.SafetyAPI.loadHealthHazards();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('healthFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Health Hazards template for audit seeding', e); }

            try{
              if(key.includes('gas')){
                const data = await window.SafetyAPI.loadGasSafety();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('gasFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Gas Safety template for audit seeding', e); }

            try{
              if(key.includes('boiler')){
                const data = await window.SafetyAPI.loadBoilerSafety();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('boilerFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Boiler Safety template for audit seeding', e); }

            try{
              if(key.includes('consultant')){
                const data = await window.SafetyAPI.loadConsultant();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('consultantFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Consultant template for audit seeding', e); }

            try{
              if(key.includes('dsa')){
                const data = await window.SafetyAPI.loadDSA();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('dsaFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load DSA template for audit seeding', e); }

            try{
              if(key.includes('emergency power')){
                const data = await window.SafetyAPI.loadEmergencyPower();
                if(data && !Array.isArray(data)){
                  out.push(...buildItemsFromChecklistForm('emergencyPowerFormData', data));
                }
              }
            }catch(e){ console.warn('Failed to load Emergency Power template for audit seeding', e); }

            return out;
          }
          function render(){
            const q = document.getElementById('auditSearch').value.trim().toLowerCase();
            const rows = _audits.filter(a=>{
              const hay = `${a.AuditName||''} ${a.AuditType||''} ${a.Status||''}`.toLowerCase();
              return !q || hay.includes(q);
            }).sort((a,b)=>{
              const av = a[_sortField]; const bv = b[_sortField];
              if(_sortField==='AuditDate'){ const da=new Date(av||0); const db=new Date(bv||0); return _sortDir==='asc'? (da-db):(db-da); }
              return _sortDir==='asc'? String(av||'').localeCompare(String(bv||'')) : String(bv||'').localeCompare(String(av||''));
            });

            const infoEl = document.getElementById('auditPageInfo');
            const countEl = document.getElementById('auditCount');
            const prevBtn = document.getElementById('auditPrev');
            const nextBtn = document.getElementById('auditNext');

            if(rows.length===0){
              tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:16px; color:#94a3b8;">No audits found</td></tr>';
              if(infoEl) infoEl.textContent = 'Page 0 of 0';
              if(countEl) countEl.textContent = 'No audits';
              if(prevBtn) prevBtn.disabled = true;
              if(nextBtn) nextBtn.disabled = true;
              return;
            }

            const total = rows.length;
            const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
            if(_page > totalPages) _page = totalPages;
            if(_page < 1) _page = 1;

            const startIndex = (_page - 1) * PAGE_SIZE;
            const endIndex = Math.min(startIndex + PAGE_SIZE, total);
            const pageRows = rows.slice(startIndex, endIndex);

            tbody.innerHTML = pageRows.map(a=>{
              const url = `/audit-verification.html?auditId=${a.Id}`;
              return `
              <tr>
                <td>${a.AuditDate? new Date(a.AuditDate).toLocaleDateString(): ''}</td>
                <td>${a.AuditName||''}</td>
                <td>${a.AuditType||''}</td>
                <td>${pill(a.Status)}</td>
                <td><a href="${url}" class="view-link" target="_blank">View</a></td>
                <td>${a.Status==='Closed'? `<a href="${url}" class="view-link" target="_blank">View</a>`:'N/A'}</td>
              </tr>`; }).join('');

            if(infoEl) infoEl.textContent = `Page ${_page} of ${totalPages}`;
            if(countEl) countEl.textContent = `Showing ${startIndex + 1}-${endIndex} of ${total}`;
            if(prevBtn) prevBtn.disabled = _page <= 1;
            if(nextBtn) nextBtn.disabled = _page >= totalPages;
          }

          async function fetchAudits(){
            const q = document.getElementById('auditSearch').value.trim();
            const params = new URLSearchParams({ tenantId: String(tenantId) }); if(q) params.set('q', q);
            const res = await fetch('/api/safety/audits?'+params.toString());
            const json = await res.json(); _audits = json.data||[]; _page = 1; render();
          }

          // Events: typing filters live; header click toggles sort
          document.getElementById('auditSearch').addEventListener('input', ()=>{ _page = 1; render(); });
          document.querySelectorAll('#auditsTable thead th[data-sort]').forEach(th=>{
            th.addEventListener('click', ()=>{ const f=th.getAttribute('data-sort'); if(_sortField===f){ _sortDir=_sortDir==='asc'?'desc':'asc'; } else { _sortField=f; _sortDir='asc'; } _page = 1; render(); });
          });

          // Pagination controls
          const _auditPrevBtn = document.getElementById('auditPrev');
          const _auditNextBtn = document.getElementById('auditNext');
          if(_auditPrevBtn) _auditPrevBtn.addEventListener('click', ()=>{ if(_page > 1){ _page--; render(); } });
          if(_auditNextBtn) _auditNextBtn.addEventListener('click', ()=>{ _page++; render(); });

          // Modal open/close and save
          const modal = document.getElementById('auditModal');
          document.getElementById('btnPlanAudit').onclick = ()=> { modal.classList.add('open'); setTimeout(()=>document.getElementById('paName')?.focus(), 0); };
          document.getElementById('closeAuditModal').onclick = ()=> modal.classList.remove('open');
          const paCancelBtn = document.getElementById('paCancel'); if(paCancelBtn) paCancelBtn.onclick = ()=> modal.classList.remove('open');
          modal.addEventListener('click', (e)=>{ if(e.target.id==='auditModal') modal.classList.remove('open'); });
          document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') modal.classList.remove('open'); });
          document.getElementById('paSave').onclick = async ()=>{
            const name = document.getElementById('paName').value.trim();
            const typesSel = Array.from(document.getElementById('paType').selectedOptions).map(o=>o.value);
            const typeStr = typesSel.join(', ');
            const company = document.getElementById('paCompany').value.trim();
            const date = document.getElementById('paDate').value;
            if(!name){ alert('Audit name required'); return; }
            const payload = { tenantId: tenantId, auditName:name, auditType:typeStr||'FIRE', auditCompany:company||null, auditDate:date||null, createdBy:'SafetyOfficer' };
            const r = await fetch('/api/safety/audits',{ method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
            const j = await r.json();
            if(j.success){
              const newId = j.id;
              // Ensure newest audits appear on top by default (latest AuditDate, descending)
              _sortField = 'AuditDate';
              _sortDir = 'desc';
              _page = 1;
              // Pre-seed checklist items for this audit from the latest master
              // safety forms (Fire, USC-Safe, Electrical, etc.).
              try{
                const items = await buildItemsForAuditTypes(typeStr || '');
                if(items && items.length){
                  await fetch(`/api/safety/audits/${newId}/items`,{
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({ items })
                  });
                }
              }catch(e){ console.warn('Failed to seed audit items from master checklists', e); }
              modal.classList.remove('open');
              await fetchAudits();
            } else {
              alert(j.error||'Failed');
            }
          };

          // Export buttons
          document.getElementById('btnExportExcel').onclick = ()=>{
            const rows = [['Audit Date','Audit Name','Related To','Status']].concat(_audits.map(a=>[
              a.AuditDate? new Date(a.AuditDate).toLocaleDateString(): '', a.AuditName||'', a.AuditType||'', a.Status||''
            ]));
            const csv = rows.map(r=>r.map(v=>`"${String(v).replace(/"/g,'""')}"`).join(',')).join('\n');
            const blob = new Blob([csv], {type:'text/csv'}); const url=URL.createObjectURL(blob);
            const a=document.createElement('a'); a.href=url; a.download='audits.csv'; a.click(); URL.revokeObjectURL(url);
          };
          document.getElementById('btnExportPDF').onclick = ()=>{
            const w = window.open('');
            const tableHtml = document.getElementById('auditsTable').outerHTML;
            w.document.write(`<html><head><meta name='viewport' content='width=device-width, initial-scale=1'><title>Audits</title><style>body{font-family:Inter,Segoe UI,system-ui,Arial} table{width:100%;border-collapse:collapse} th,td{border:1px solid #e2e8f0;padding:8px} th{background:#f8fafc;text-transform:uppercase;font-size:12px}</style></head><body><h3>Safety Audits</h3>${tableHtml}</body></html>`);
            w.document.close(); w.focus(); w.print(); w.close();
          };

          fetchAudits();
        }

        async function showSafetyAgent(){
          const pane = document.querySelector('.working-pane');
          if(!pane) return;
          pane.style.display='block'; pane.style.alignItems='stretch'; pane.style.justifyContent='flex-start'; pane.style.padding='0';
          pane.innerHTML = `
            <div style="padding:14px 16px;">
              <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-bottom:8px;">
                <div style="font-size:22px;font-weight:800;letter-spacing:-0.02em">SAFETY AGENT</div>
              </div>
              <div class="dashboard-card" style="padding:16px;border:1px solid #e2e8f0;border-radius:12px;">
                <form id="agentForm" style="display:flex;gap:10px;align-items:flex-start;flex-wrap:wrap">
                  <textarea id="agentText" placeholder="Type instructions or context (optional)" style="flex:1 1 340px;min-height:92px;padding:10px 12px;border:1px solid #e2e8f0;border-radius:8px;font:inherit"></textarea>
                  <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-start">
                    <input type="file" id="agentFile" />
                    <button class="action-button add-btn" id="agentSubmit" type="submit">Submit</button>
                  </div>
                </form>
                <div id="agentRes" style="margin-top:12px"></div>
              </div>
            </div>`;

          const res = document.getElementById('agentRes');
          function esc(s){ return String(s).replace(/[&<>"']/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c])); }
          async function api(path, opts){ const r = await fetch(path, opts); const j = await r.json().catch(()=>({success:false,error:'Invalid response'})); if(!j.success) throw new Error(j.error||'Request failed'); return j.data||{}; }
          document.getElementById('agentForm').addEventListener('submit', async (e)=>{
            e.preventDefault();
            res.innerHTML = '<div style="color:#64748b">Working...</div>';
            const f = document.getElementById('agentFile').files[0];
            const text = (document.getElementById('agentText').value||'').trim();
            try{
              let data;
              if(f){
                const fd = new FormData(); fd.append('file', f); if(text) fd.append('notes', text);
                data = await api('/api/safety/agent/upload', { method:'POST', body: fd, credentials:'include' });
              }else{
                data = await api('/api/safety/agent/propose', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ text }), credentials:'include' });
              }
              const items = (data.proposedItems||[]).map(p=>`<li><span style="display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff;color:#3730a3;font-weight:700;font-size:12px">${esc(p.targetTable)}</span> <span class="muted">${esc(p.action)}</span> <code>${esc(JSON.stringify(p.payload))}</code></li>`).join('');
              const facts = (data.facts||[]).map(f=>`<li>${esc(f)}</li>`).join('');
              res.innerHTML = `
                <div class="dashboard-card" style="padding:16px">
                  <div style="font-weight:800">Proposal #${data.proposalId}</div>
                  <div style="margin:8px 0" class="muted">Approve to write to database. Nothing is saved until you approve.</div>
                  <div style="display:flex;gap:8px;margin:8px 0">
                    <button class="action-button save-btn" id="apv">Approve & Apply</button>
                    <button class="action-button cancel-btn" id="rej">Reject</button>
                  </div>
                  <div style="margin-top:8px"><div style="font-weight:700">Extracted Facts</div><ul>${facts||'<li>No facts</li>'}</ul></div>
                  <div style="margin-top:8px"><div style="font-weight:700">Proposed Changes</div><ul>${items||'<li>No changes</li>'}</ul></div>
                </div>`;
              document.getElementById('apv').onclick = async()=>{ try{ await api(`/api/safety/agent/proposals/${data.proposalId}/approve`, { method:'POST', credentials:'include' }); alert('Approved and applied'); }catch(ex){ alert(ex.message);} };
              document.getElementById('rej').onclick = async()=>{ try{ await api(`/api/safety/agent/proposals/${data.proposalId}/reject`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({reason:'User rejected'}), credentials:'include' }); alert('Rejected'); }catch(ex){ alert(ex.message);} };
            }catch(ex){ res.innerHTML = `<div style="color:#ef4444">${esc(ex.message)}</div>`; }
          });
        }

        function toggleUserMenu(ev){
          try{
            if(ev){ ev.preventDefault(); ev.stopPropagation(); }
            const menu = document.getElementById('user-menu');
            if(!menu) return;
            menu.classList.toggle('open');
          }catch(e){}
        }

        document.addEventListener('click', function(e){
          const menu = document.getElementById('user-menu');
          const badge = document.querySelector('.user-badge');
          if(!menu || !badge) return;
          if(badge.contains(e.target) || menu.contains(e.target)) return;
          menu.classList.remove('open');
        });

        function signOut(){
          const confirmSignOut = window.confirm('Do you want to sign out?');
          if(!confirmSignOut) return false;
          try{
            fetch('/api/auth/logout', { method: 'POST', credentials: 'include' })
              .catch(()=>{})
              .finally(()=>{ window.location.href = '/login'; });
          }catch(e){ window.location.href = '/login'; }
          return false;
        }
      </script>
      <script>
        // Initialize multi-agent panel for Safety module
        document.addEventListener('DOMContentLoaded', function(){
          if (window.AgentUI) {
            window.AgentUI.initModuleAgents({
              containerSelector: '#safety-agents-panel',
              moduleId: 'safety'
            });
          }
        });
      </script>
      <script>
        function switchTab(key){
          try{
            const pane=document.querySelector('.working-pane'); if(!pane) return;
            const id='tab-'+key; const section=document.getElementById(id);
            pane.style.display='block'; pane.style.alignItems='stretch'; pane.style.justifyContent='flex-start'; pane.style.padding='0';
            if(!section){ pane.innerHTML = '<div style="padding:16px;color:#64748b">Section not found: '+key+'</div>'; return; }
            // Activate and move the section into the working pane
            section.classList.add('active');
            pane.innerHTML = '';
            pane.appendChild(section);
            // Scroll to top inside working area
            pane.scrollTop = 0;
          }catch(e){ console.warn('switchTab failed', e); }
        }
      </script>

      <!-- Quick Links -->
      <div class="dashboard-card full-width-card">
        <div class="card-header">Quick Links</div>
        <div class="action-buttons" style="grid-template-columns: repeat(3, 1fr);">
          <a class="action-btn" href="/safety-audits.html">
            <div class="action-icon">üìã</div>
            <div class="action-label">Safety Audits</div>
          </a>
          <a class="action-btn" href="/training.html">
            <div class="action-icon">üéì</div>
            <div class="action-label">Training</div>
          </a>
          <a class="action-btn" href="/attendance/scan.html">
            <div class="action-icon">üßæ</div>
            <div class="action-label">Attendance Scan</div>
          </a>
          <a class="action-btn" href="/attendance/admin.html">
            <div class="action-icon">üß∞</div>
            <div class="action-label">Attendance Admin</div>
          </a>
          <a class="action-btn" href="/ai/analyst.html">
            <div class="action-icon">ü§ñ</div>
            <div class="action-label">AI Analyst</div>
          </a>
          <a class="action-btn" href="/suppliers/rfq.html">
            <div class="action-icon">üöö</div>
            <div class="action-label">Supplier RFQs</div>
          </a>
          <a class="action-btn" href="/hr/index.html">
            <div class="action-icon">üë•</div>
            <div class="action-label">HR & Payroll</div>
          </a>
          <a class="action-btn" href="/accounting/index.html">
            <div class="action-icon">üí∞</div>
            <div class="action-label">Accounting</div>
          </a>
          <a class="action-btn" href="/billing.html">
            <div class="action-icon">üí≥</div>
            <div class="action-label">Billing</div>
          </a>
          <a class="action-btn" href="/support.html">
            <div class="action-icon">üí¨</div>
            <div class="action-label">Chat/Support</div>
          </a>
          <a class="action-btn" href="mailto:?subject=Safety%20Office">
            <div class="action-icon">‚úâÔ∏è</div>
            <div class="action-label">Email</div>
          </a>
          <a class="action-btn" href="/tasks/planning.html">
            <div class="action-icon">üóìÔ∏è</div>
            <div class="action-label">Task Planner</div>
          </a>
        </div>
      </div>

      </div> <!-- Close dashboard-content -->
    </div> <!-- Close tab-overview -->

    <!-- Incidents Tab -->
    <div id="tab-incidents" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">INCIDENT REPORTING</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('incidents')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>


        <div id="incident-form" class="form-container" style="padding: 20px;">
          <form id="incidentFormData" onsubmit="saveIncident(event)">
            
            <!-- Basic Incident Information -->
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 16px; margin-bottom: 20px;">
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Date & Time of Incident:</label>
                <input type="datetime-local" name="incidentDateTime" required style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Employee ID of Person Reporting:</label>
                <input type="text" name="employeeId" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Name of Person Reporting:</label>
                <input type="text" name="reporterName" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Job Title of Person Reporting:</label>
                <input type="text" name="reporterJobTitle" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Name of Person Writing:</label>
                <input type="text" name="writerName" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
            </div>

            <!-- Type of Incident -->
            <div style="margin-bottom: 20px;">
              <label style="font-size: 13px; font-weight: 600; color: #0f172a; margin-bottom: 8px; display: block;">Type of Incident</label>
              <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Fire" style="width: 16px; height: 16px;" checked> Fire
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Explosion" style="width: 16px; height: 16px;"> Explosion
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Collapse" style="width: 16px; height: 16px;"> Collapse
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Electrical Incident" style="width: 16px; height: 16px;"> Electrical Incident
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Chemical Incident" style="width: 16px; height: 16px;"> Chemical Incident
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Machinery Incident" style="width: 16px; height: 16px;"> Machinery Incident
                </label>
                <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                  <input type="radio" name="incidentType" value="Other" style="width: 16px; height: 16px;"> Other
                </label>
              </div>
            </div>

            <!-- Location and Description -->
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin-bottom: 20px;">
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Location of the Incident:</label>
                <input type="text" name="location" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Description of Incident:</label>
                <input type="text" name="description" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">In which department the incident occurred?</label>
                <select name="department" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px;">
                  <option value="Accounts">Accounts</option>
                  <option value="Production">Production</option>
                  <option value="Quality">Quality</option>
                  <option value="Maintenance">Maintenance</option>
                  <option value="HR">HR</option>
                  <option value="Safety">Safety</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>

            <!-- INJURED PERSON INFORMATION -->
            <div style="margin-bottom: 24px;">
              <h3 style="font-size: 15px; font-weight: 600; color: #0d9488; margin-bottom: 12px; text-transform: uppercase;">INJURED PERSON INFORMATION</h3>
              <div style="text-align: right; margin-bottom: 12px;">
                <button type="button" class="action-button add-btn" onclick="addInjuredPerson()" style="padding: 8px 16px; font-size: 13px;">Add Injured Person</button>
              </div>
              <div id="injuredPersonsContainer">
                <!-- Injured persons will be added dynamically here -->
              </div>
            </div>

            <!-- DAMAGED EQUIPMENT -->
            <div style="margin-bottom: 24px;">
              <h3 style="font-size: 15px; font-weight: 600; color: #0d9488; margin-bottom: 12px; text-transform: uppercase;">DAMAGED EQUIPMENT</h3>
              <div style="text-align: right; margin-bottom: 12px;">
                <button type="button" class="action-button add-btn" onclick="addDamagedEquipment()" style="padding: 8px 16px; font-size: 13px;">Add damaged Equipment</button>
              </div>
              <div id="damagedEquipmentContainer">
                <!-- Damaged equipment will be added dynamically here -->
              </div>
            </div>

            <!-- ENVIRONMENTAL IMPACT -->
            <div style="margin-bottom: 24px;">
              <h3 style="font-size: 15px; font-weight: 600; color: #0d9488; margin-bottom: 12px; text-transform: uppercase;">ENVIRONMENTAL IMPACT</h3>
              
              <div style="margin-bottom: 16px;">
                <label style="font-size: 13px; font-weight: 500; color: #0f172a; margin-bottom: 8px; display: block;">Environmental impact by the incident (if any):</label>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envWaterPollution" style="width: 16px; height: 16px;"> Water pollution
                  </label>
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envAirPollution" style="width: 16px; height: 16px;"> Air pollution
                  </label>
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envSoilContamination" style="width: 16px; height: 16px;"> Soil contamination
                  </label>
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envEnergyConsumption" style="width: 16px; height: 16px;"> Energy consumption
                  </label>
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envWasteGeneration" style="width: 16px; height: 16px;"> Waste generation
                  </label>
                  <label style="font-size: 13px; display: flex; align-items: center; gap: 6px;">
                    <input type="checkbox" name="envChemicalExposure" style="width: 16px; height: 16px;"> Chemical exposure
                  </label>
                </div>
              </div>

              <div class="form-group full-width">
                <label style="font-size: 12px; font-weight: 500; color: #64748b; margin-bottom: 4px; display: block;">Description of Environmental impact:</label>
                <textarea name="envImpactDescription" rows="4" style="width: 100%; font-size: 13px; padding: 8px; border: 1px solid #e2e8f0; border-radius: 6px; resize: vertical;"></textarea>
              </div>
            </div>

            <div class="form-actions" style="display: flex; gap: 12px; justify-content: flex-start; margin-top: 24px; padding-top: 20px; border-top: 2px solid #e2e8f0;">
              <button type="button" class="action-button back-btn" onclick="goToDashboard()" style="background: #e2e8f0; color: #64748b; padding: 10px 20px;">Back</button>
              <button type="submit" class="action-button save-btn" style="padding: 10px 20px;">Save</button>
            </div>
          </form>
        </div>

        <div id="incident-table" class="data-table-container" style="margin-top: 24px;">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date & Time</th>
                <th>Type</th>
                <th>Location</th>
                <th>Department</th>
                <th>Reporter</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="incident-table-body">
              <tr><td colspan="8" style="text-align:center; padding:20px;">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Search Incident Tab -->
    <div id="tab-search-incident" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">SEARCH INCIDENT</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('search-incidents')">üìä Export To Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>

        <!-- Tab Navigation for Sub-sections -->
        <div style="display: flex; gap: 8px; margin: 16px 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 0; overflow-x: auto;">
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">USC-Safe</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Fire Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Electrical Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Gas</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Boiler Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Consultant Engagement</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">DSA</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Emergency Power</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Health Hazard</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Structural Details</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Incident Reporting</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px; background: #0d9488; color: white; border-bottom: 3px solid #0d9488;">Search Incident</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Complaint/Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Safety Training</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">UNGP Checklist</button>
        </div>

        <!-- Search Bar -->
        <div style="display: flex; gap: 12px; margin: 20px 0; align-items: center;">
          <input type="text" id="searchIncidentInput" placeholder="Type to Search..." 
                 style="flex: 1; max-width: 400px; padding: 10px 16px; font-size: 14px; border: 1px solid #cbd5e1; border-radius: 8px; outline: none;"
                 onkeyup="filterIncidents()">
          <button class="action-button" onclick="searchIncidents()" 
                  style="background: #0d9488; color: white; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Search</button>
          <button class="action-button" onclick="goToDashboard()" 
                  style="background: #14b8a6; color: white; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Back</button>
        </div>

        <!-- Search Results Table -->
        <div id="search-incident-table" class="data-table-container" style="margin-top: 24px;">
          <table class="data-table">
            <thead>
              <tr>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Date</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Employee Name</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Job Title</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Incident Type</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Location</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Department</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Status</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: center; border-bottom: 2px solid #e2e8f0;">VIEW</th>
              </tr>
            </thead>
            <tbody id="search-incident-table-body">
              <!-- Sample Data Row -->
              <tr style="border-bottom: 1px solid #f1f5f9;">
                <td style="padding: 12px;">7/10/2024</td>
                <td style="padding: 12px;">Jane Doe</td>
                <td style="padding: 12px;">Machine Operator</td>
                <td style="padding: 12px;">Machinery Incident</td>
                <td style="padding: 12px;">Production Floor - Line 3</td>
                <td style="padding: 12px;">Production</td>
                <td style="padding: 12px;">
                  <span style="display: inline-block; padding: 4px 12px; background: #fee2e2; color: #dc2626; border-radius: 12px; font-size: 11px; font-weight: 600;">Open</span>
                </td>
                <td style="padding: 12px; text-align: center;">
                  <button onclick="viewIncident(1)" style="background: #0d9488; color: white; padding: 6px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 12px;">View</button>
                </td>
              </tr>
              <!-- Additional rows will be populated dynamically -->
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Grievances Tab -->
    <div id="tab-grievances" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">COMPLAINT/GRIEVANCE</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('grievances')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>

        <div id="grievance-form" class="form-container" style="padding: 20px;">
          <form id="grievanceFormData" onsubmit="saveGrievance(event)">

            <!-- Header Information -->
            <div class="form-grid" style="gap: 12px;">
              <div class="form-group">
                <label style="font-size: 13px;">Date of complaint</label>
                <input type="date" name="dateOfComplaint" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Employee ID</label>
                <input type="text" name="employeeId" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Employee Name</label>
                <input type="text" name="employeeName" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Department</label>
                <input type="text" name="department" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Job Title</label>
                <input type="text" name="jobTitle" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Contact number</label>
                <input type="text" name="contactNumber" style="font-size: 13px; padding: 6px;">
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Union</label>
                <select name="union" style="font-size: 13px; padding: 6px;">
                  <option value="">Select</option>
                  <option>Yes</option>
                  <option>No</option>
                </select>
              </div>
              <div class="form-group">
                <label style="font-size: 13px;">Union Name</label>
                <input type="text" name="unionName" style="font-size: 13px; padding: 6px;">
              </div>
            </div>

            <!-- Complaint Types -->
            <div class="form-group full-width" style="margin-top: 10px;">
              <label style="font-size: 13px; font-weight: 600;">Select the type of complaints</label>
              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 6px;">
                <label style="font-size: 12px;"><input type="checkbox" name="type_sexual_harassment"> Sexual Harassment</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_violence"> Violence</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_excessive_hours"> Excessive Work Hours</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_maternity_pay"> Maternity Leave and Pay</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_dust_fiber"> Dust and Fiber Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_chemical"> Chemical Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_noise"> Noise Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_ergonomic"> Ergonomic Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_stress"> Stress Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_heat_stress"> Heat Stress Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_machine"> Machine Hazard</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_forced_labor"> Forced Labor</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_child_labor"> Child Labor</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_unsafe_conditions"> Unsafe Working Conditions</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_denial_rights"> Denial of worker's rights</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_other"> Other</label>
                <label style="font-size: 12px;"><input type="checkbox" name="type_discrimination"> Discrimination</label>
              </div>
            </div>

            <!-- Sections -->
            <div style="display: grid; grid-template-columns: 1fr; gap: 14px;">
              <!-- Sexual Harassment -->
              <div class="form-group full-width" style="margin-top: 6px;">
                <label style="font-weight: 600;">Details for: Sexual Harassment</label>
                <input type="text" name="sh_nameOfAccused" placeholder="Name of Accused" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <div class="form-grid" style="margin-top:8px; gap:12px;">
                  <div class="form-group"><label>Date of incident</label><input type="date" name="sh_date"></div>
                  <div class="form-group"><label>Witnesses (if any)</label><input type="text" name="sh_witnesses"></div>
                </div>
                <textarea name="sh_description" rows="2" placeholder="Description of incident" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Violence -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Violence</label>
                <input type="text" name="vio_nameOfAccused" placeholder="Name of Accused" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <div class="form-grid" style="margin-top:8px; gap:12px;">
                  <div class="form-group"><label>Date of incident</label><input type="date" name="vio_date"></div>
                  <div class="form-group"><label>Witnesses (if any)</label><input type="text" name="vio_witnesses"></div>
                </div>
                <textarea name="vio_description" rows="2" placeholder="Description of incident" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Excessive Work Hours -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Excessive Work Hours</label>
                <input type="text" name="ewh_minutes" placeholder="How many extra minutes did you work?" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
              </div>

              <!-- Maternity Leave and Pay -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Maternity Leave and Pay</label>
                <div class="form-grid" style="gap:12px; margin-top:6px;">
                  <div class="form-group"><label>Leave Detail Date</label><input type="date" name="mat_leave_date"></div>
                  <div class="form-group"><label>Expected Return Date</label><input type="date" name="mat_return_date"></div>
                  <div class="form-group"><label>Date of Pay Discrepancy</label><input type="date" name="mat_pay_date"></div>
                </div>
                <textarea name="mat_pay_details" rows="2" placeholder="Details of Pay Discrepancy" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Dust and Fiber Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Dust and Fiber Hazard</label>
                <input type="text" name="df_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="df_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Chemical Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Chemical Hazard</label>
                <input type="text" name="chem_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="chem_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Noise Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Noise Hazard</label>
                <input type="text" name="noise_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="noise_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Ergonomic Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Ergonomic Hazard</label>
                <input type="text" name="ergo_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="ergo_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Stress Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Stress Hazard</label>
                <input type="text" name="stress_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="stress_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Heat Stress Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Heat Stress Hazard</label>
                <input type="text" name="heat_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="heat_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Machine Hazard -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Machine Hazard</label>
                <input type="text" name="machine_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="machine_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Forced Labor -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Forced Labor</label>
                <textarea name="forced_labor_details" rows="2" placeholder="Description of coercion/forced work" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Child Labor -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Child Labor</label>
                <div class="form-grid" style="gap:12px;">
                  <div class="form-group"><label>Child's approximate age</label><input type="number" name="child_age" min="0" style="padding:6px;"></div>
                </div>
                <textarea name="child_labor_description" rows="2" placeholder="Description of child's work" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Unsafe Working Conditions -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Unsafe Working Conditions</label>
                <input type="text" name="unsafe_location" placeholder="Location of Hazard" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <textarea name="unsafe_description" rows="2" placeholder="Description of Hazard" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Denial of workers' rights -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Denial of workers' rights</label>
                <textarea name="denial_rights_details" rows="2" placeholder="Describe the right that was denied and the situation" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Other -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Other</label>
                <textarea name="other_details" rows="2" placeholder="Please specify the nature of your complaint" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>

              <!-- Discrimination -->
              <div class="form-group full-width">
                <label style="font-weight: 600;">Details for: Discrimination</label>
                <input type="text" name="disc_nameOfAccused" placeholder="Name of Accused" style="margin-top:6px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;">
                <div class="form-grid" style="margin-top:8px; gap:12px;">
                  <div class="form-group"><label>Date of incident</label><input type="date" name="disc_date"></div>
                  <div class="form-group"><label>Witnesses (if any)</label><input type="text" name="disc_witnesses"></div>
                </div>
                <textarea name="disc_description" rows="2" placeholder="Description of incident" style="margin-top:8px; padding:8px; border:1px solid #e2e8f0; border-radius:6px;"></textarea>
              </div>
            </div>

            <div class="form-actions" style="display: flex; gap: 12px; justify-content: flex-start; margin-top: 24px;">
              <button type="button" class="action-button back-btn" onclick="goToDashboard()">Back</button>
              <button type="submit" class="action-button save-btn">Save</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Search Grievance Tab -->
    <div id="tab-search-grievance" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">SEARCH GRIEVANCE</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('search-grievances')">üìä Export To Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>

        <!-- Tab Navigation for Sub-sections -->
        <div style="display: flex; gap: 8px; margin: 16px 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 0; overflow-x: auto;">
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">USC-Safe</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Fire Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Electrical Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Gas</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Boiler Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Consultant Engagement</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">DSA</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Emergency Power</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Health Hazard</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Structural Details</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Incident Reporting</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Incident</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Complaint/Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px; background: #0d9488; color: white; border-bottom: 3px solid #0d9488;">Search Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Safety Training</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">UNGP Checklist</button>
        </div>

        <!-- Search Bar -->
        <div style="display: flex; gap: 12px; margin: 20px 0; align-items: center;">
          <input type="text" id="searchGrievanceInput" placeholder="Search by name or department" 
                 style="flex: 1; max-width: 400px; padding: 10px 16px; font-size: 14px; border: 1px solid #cbd5e1; border-radius: 8px; outline: none;"
                 onkeyup="filterGrievances()">
          <button class="action-button" onclick="searchGrievances()" 
                  style="background: #0d9488; color: white; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Search</button>
        </div>

        <!-- Search Results Table -->
        <div id="search-grievance-table" class="data-table-container" style="margin-top: 24px;">
          <table class="data-table">
            <thead>
              <tr>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Date</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Employee Name</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Department</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">COMPLAINT TYPES</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: left; border-bottom: 2px solid #e2e8f0;">Status</th>
                <th style="background: #f8fafc; padding: 12px; font-weight: 600; text-align: center; border-bottom: 2px solid #e2e8f0;">VIEW</th>
              </tr>
            </thead>
            <tbody id="search-grievance-table-body">
              <!-- Sample Data Row (to be populated dynamically) -->
              <tr style="border-bottom: 1px solid #f1f5f9;">
                <td style="padding: 12px;" colspan="6">
                  <div style="text-align: center; padding: 40px; color: #94a3b8;">
                    <p style="font-size: 14px; margin: 0;">No grievances found. Use the search above to find grievances.</p>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Safety Training Tab -->
    <div id="tab-safety-training" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">SAFETY TRAINING</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('safety-training')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>

        <!-- Tab Navigation for Sub-sections -->
        <div style="display: flex; gap: 8px; margin: 16px 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 0; overflow-x: auto;">
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">USC-Safe</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Fire Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Electrical Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Gas</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Boiler Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Consultant Engagement</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">DSA</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Emergency Power</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Health Hazard</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Structural Details</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Incident Reporting</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Incident</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Complaint/Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px; background: #0d9488; color: white; border-bottom: 3px solid #0d9488;">Safety Training</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">UNGP Checklist</button>
        </div>

        <div id="safety-training-form" class="form-container" style="padding: 20px;">
          <h3 style="font-size: 16px; font-weight: 700; color: #0f172a; margin-bottom: 20px;">SAFETY TRAINING CHECKLIST</h3>
          
          <form id="safetyTrainingFormData" onsubmit="saveSafetyTraining(event)">
            
            <!-- Checklist Table -->
            <table style="width: 100%; border-collapse: collapse; margin-bottom: 24px;">
              <thead>
                <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                  <th style="padding: 12px; text-align: left; font-weight: 600; font-size: 13px; color: #475569; width: 20%;">Section</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; font-size: 13px; color: #475569; width: 55%;">Requirement</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">Yes</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">No</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 9%;">N/A</th>
                </tr>
              </thead>
              <tbody>
                <!-- A. Introductory Meeting -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;">A. Introductory Meeting</td>
                  <td style="padding: 12px; color: #475569;">Meeting attendance records for the introductory session are properly maintained.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_attendance" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_attendance" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_attendance" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Worker representatives participated in the introductory meeting.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_workers" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_workers" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_workers" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The training program objectives and session schedule were clearly introduced.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_objectives" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_objectives" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_objectives" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">A qualified safety trainer conducted an introductory meeting with management and worker representatives.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_qualified" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_qualified" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="intro_qualified" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- B. Safety Training Curriculum -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;">B. Safety Training Curriculum</td>
                  <td style="padding: 12px; color: #475569;">Practical walk-throughs were conducted to identify actual or potential workplace hazards (e.g. machine use, obstacles, ventilation).</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_walkthrough" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_walkthrough" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_walkthrough" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Training covered hazard identification methods relevant to the workplace.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_hazard_id" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_hazard_id" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_hazard_id" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">A structured multi-module safety training program was delivered to all committee members.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_multimodule" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_multimodule" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_multimodule" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Training addressed the protection of workers' rights related to health and safety.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_rights" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_rights" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_rights" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Training explained the committee's role in monitoring safety remediation and preventive actions.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_committee_role" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_committee_role" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_committee_role" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Joint problem-solving exercises were included during the training.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_exercises" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_exercises" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_exercises" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Attendance records and training materials are documented and easily accessible.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_records" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_records" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_records" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Procedures for reporting and tracking safety issues were taught.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_reporting" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_reporting" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_reporting" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Training included methods for handling and resolving health and safety complaints.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_complaints" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_complaints" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_complaints" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Each training module was conducted for an adequate duration to ensure understanding.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_duration" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_duration" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="curr_duration" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- C. All Employee Safety Meetings -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;">C. All Employee Safety Meetings</td>
                  <td style="padding: 12px; color: #475569;">Workers were informed on how to raise safety concerns through appropriate channels.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_concerns" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_concerns" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_concerns" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Records of employee meetings, presentations, and information distributed are maintained.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_records" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_records" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_records" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Information was shared on safe evacuation procedures during emergencies.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_evacuation" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_evacuation" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_evacuation" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">A series of three safety meetings for all employees were conducted.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_three_meetings" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_three_meetings" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_three_meetings" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Members of the Safety Committee were formally introduced to all employees.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_committee_intro" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_committee_intro" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_committee_intro" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Production was temporarily halted during the meetings to ensure full participation.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_production_halted" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_production_halted" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_production_halted" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Safety presentations were delivered to all employees and management during each meeting.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_presentations" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_presentations" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_presentations" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Booklets or information materials covering key safety topics were distributed to all employees.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_materials" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_materials" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_materials" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Information on identifying and reducing common workplace hazards was shared.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_hazards" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_hazards" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="emp_hazards" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- D. Safety Committee Functions -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;">D. Safety Committee Functions</td>
                  <td style="padding: 12px; color: #475569;">The committee regularly reviews accident and incident reports and discusses preventive measures.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_reviews" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_reviews" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_reviews" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The committee holds regular meetings, at least once every three months.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_meetings" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_meetings" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_meetings" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The committee conducts routine factory or workplace inspections to identify hazards.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_inspections" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_inspections" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_inspections" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The committee responds promptly and effectively to workers' health and safety concerns.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_responds" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_responds" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_responds" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The committee actively communicates health and safety information to the workforce.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_communicates" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_communicates" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="comm_communicates" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- E. Ongoing Support -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;">E. Ongoing Support</td>
                  <td style="padding: 12px; color: #475569;">Ongoing communication and support activities between the committee and trainer/consultant are documented.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_communication" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_communication" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_communication" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">A qualified safety trainer or consultant is available as a point of contact for the committee.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_trainer" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_trainer" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_trainer" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">The training program is periodically reviewed and updated for effectiveness.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_reviewed" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_reviewed" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_reviewed" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px;"></td>
                  <td style="padding: 12px; color: #475569;">Committee members can seek additional support or clarification from the trainer/consultant as needed.</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_additional" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_additional" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="support_additional" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
              </tbody>
            </table>

            <!-- Additional Notes & Attachments -->
            <div style="margin-bottom: 20px;">
              <details style="background: #f8fafc; padding: 16px; border-radius: 8px; border: 1px solid #e2e8f0;">
                <summary style="cursor: pointer; font-weight: 600; font-size: 14px; color: #0f172a;">Additional Notes & Attachments</summary>
                <div style="margin-top: 12px;">
                  <textarea name="additionalNotes" rows="4" placeholder="Add any additional notes or comments..." 
                            style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 13px;"></textarea>
                </div>
              </details>
            </div>

            <div class="form-actions" style="display: flex; gap: 12px; justify-content: flex-start;">
              <button type="button" class="action-button" onclick="goToDashboard()" 
                      style="background: #e2e8f0; color: #64748b; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Back</button>
              <button type="submit" class="action-button save-btn" 
                      style="background: #0d9488; color: white; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Save</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- UNGP Checklist Tab -->
    <div id="tab-ungp" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span style="font-size: 18px; font-weight: 700;">UNGP CHECKLIST</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('ungp-checklist')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>

        <!-- Tab Navigation for Sub-sections -->
        <div style="display: flex; gap: 8px; margin: 16px 0; border-bottom: 2px solid #e2e8f0; padding-bottom: 0; overflow-x: auto;">
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">USC-Safe</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Fire Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Electrical Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Gas</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Boiler Safety</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Consultant Engagement</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">DSA</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Emergency Power</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Health Hazard</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Structural Details</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Incident Reporting</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Incident</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Complaint/Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Search Grievance</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px;">Safety Training</button>
          <button class="tab-item" style="min-width: auto; padding: 10px 16px; font-size: 13px; background: #0d9488; color: white; border-bottom: 3px solid #0d9488;">UNGP Checklist</button>
        </div>

        <div id="ungp-form" class="form-container" style="padding: 20px;">
          <h3 style="font-size: 16px; font-weight: 700; color: #0f172a; margin-bottom: 8px;">COMPLIANCE CHECKLIST (BASED ON THE UNGPS)</h3>
          <p style="font-size: 13px; color: #64748b; margin-bottom: 20px;">Human rights / social responsibility compliance (grievance, worker rights, transparency, etc.)</p>
          
          <form id="ungpFormData" onsubmit="saveUNGPChecklist(event)">
            
            <!-- Checklist Table -->
            <table style="width: 100%; border-collapse: collapse; margin-bottom: 24px;">
              <thead>
                <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                  <th style="padding: 12px; text-align: left; font-weight: 600; font-size: 13px; color: #475569; width: 18%;">Section</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">Principle</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; font-size: 13px; color: #475569; width: 50%;">Checklist Item</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">Yes</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">No</th>
                  <th style="padding: 12px; text-align: center; font-weight: 600; font-size: 13px; color: #475569; width: 8%;">N/A</th>
                </tr>
              </thead>
              <tbody>
                <!-- A. State Duty to Protect -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;" rowspan="7">A. State Duty to Protect</td>
                  <td style="padding: 12px; text-align: center; color: #475569;">1</td>
                  <td style="padding: 12px; color: #475569;">Has the state enacted laws requiring businesses to respect human rights?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_1" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_1" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_1" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">2</td>
                  <td style="padding: 12px; color: #475569;">Does the state enforce those laws and monitor compliance?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_2" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_2" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_2" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">3</td>
                  <td style="padding: 12px; color: #475569;">Does the state provide guidance to businesses on how to implement human rights?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_3" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_3" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_3" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">4</td>
                  <td style="padding: 12px; color: #475569;">Does the state require or encourage businesses to publicly report on human rights?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_4" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_4" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_4" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">5</td>
                  <td style="padding: 12px; color: #475569;">Are state-owned enterprises and public support agencies (e.g. export credit) also required to do human rights due diligence?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_5" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_5" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_5" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">6</td>
                  <td style="padding: 12px; color: #475569;">In conflict zones, does the state take special measures to avoid business involvement in abuses?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_6" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_6" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_6" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">7</td>
                  <td style="padding: 12px; color: #475569;">Are government procurement policies (trade, investment, corporate law) aligned with human rights obligations?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_7" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_7" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="state_7" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- B. Business Responsibility to Respect -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;" rowspan="9">B. Business Responsibility to Respect</td>
                  <td style="padding: 12px; text-align: center; color: #475569;">8</td>
                  <td style="padding: 12px; color: #475569;">Has the company adopted a human rights policy, approved at senior level, communicated internally and externally?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_8" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_8" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_8" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">9</td>
                  <td style="padding: 12px; color: #475569;">Does the company assess actual/potential human rights impacts from its own activities and its value chain?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_9" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_9" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_9" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">10</td>
                  <td style="padding: 12px; color: #475569;">Are affected and potentially affected stakeholders consulted meaningfully?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_10" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_10" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_10" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">11</td>
                  <td style="padding: 12px; color: #475569;">Are findings from the impact assessment integrated into business processes and appropriate actions taken?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_11" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_11" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_11" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">12</td>
                  <td style="padding: 12px; color: #475569;">Are responses tracked (qualitative/quantitative) and feedback used to adjust?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_12" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_12" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_12" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">13</td>
                  <td style="padding: 12px; color: #475569;">Does the company publicly communicate how it addresses human rights impacts (especially when risks are high)?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_13" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_13" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_13" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">14</td>
                  <td style="padding: 12px; color: #475569;">If impacts occur, does the business provide or cooperate in remediation, or maintain grievance mechanisms?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_14" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_14" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_14" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">15</td>
                  <td style="padding: 12px; color: #475569;">When facing multiple risks, does the business prioritize the most severe / hardest to remedy impacts first?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_15" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_15" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_15" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">16</td>
                  <td style="padding: 12px; color: #475569;">In contexts of conflicting laws, does the business seek to act in line with international human rights to the greatest extent possible?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_16" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_16" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="business_16" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>

                <!-- C. Access to Remedy -->
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; font-weight: 600; vertical-align: top; color: #0f172a;" rowspan="5">C. Access to Remedy</td>
                  <td style="padding: 12px; text-align: center; color: #475569;">17</td>
                  <td style="padding: 12px; color: #475569;">Are there judicial or state grievance mechanisms accessible to victims of business-related abuses?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_17" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_17" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_17" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">18</td>
                  <td style="padding: 12px; color: #475569;">Does the state require or present legal, procedural, financial barriers to remedy?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_18" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_18" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_18" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">19</td>
                  <td style="padding: 12px; color: #475569;">Does the business have its own grievance mechanism (independent, accessible, fair) for affected parties?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_19" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_19" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_19" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">20</td>
                  <td style="padding: 12px; color: #475569;">Are remedies (apology, restitution, compensation, guarantees) available and meaningful?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_20" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_20" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_20" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
                <tr style="border-bottom: 1px solid #e2e8f0;">
                  <td style="padding: 12px; text-align: center; color: #475569;">21</td>
                  <td style="padding: 12px; color: #475569;">Are there other means (e.g. mediation, industry schemes) complementing judicial remedy?</td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_21" value="Yes" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_21" value="No" style="width: 16px; height: 16px;"></td>
                  <td style="padding: 12px; text-align: center;"><input type="radio" name="remedy_21" value="N/A" style="width: 16px; height: 16px;"></td>
                </tr>
              </tbody>
            </table>

            <!-- Additional Notes & Attachments -->
            <div style="margin-bottom: 20px;">
              <details style="background: #f8fafc; padding: 16px; border-radius: 8px; border: 1px solid #e2e8f0;">
                <summary style="cursor: pointer; font-weight: 600; font-size: 14px; color: #0f172a;">Additional Notes & Attachments</summary>
                <div style="margin-top: 12px;">
                  <label style="display: block; font-size: 13px; color: #475569; margin-bottom: 8px;">Comments / Notes</label>
                  <textarea name="comments" rows="4" placeholder="Add any additional comments or notes..." 
                            style="width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 13px; margin-bottom: 16px;"></textarea>
                  
                  <label style="display: block; font-size: 13px; color: #475569; margin-bottom: 8px;">Attach File</label>
                  <div style="display: flex; gap: 12px; align-items: center;">
                    <button type="button" onclick="document.getElementById('ungpFileInput').click()" 
                            style="padding: 8px 16px; background: #f1f5f9; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 13px; cursor: pointer;">Browse...</button>
                    <span id="ungpFileName" style="font-size: 13px; color: #64748b;">No file selected.</span>
                  </div>
                  <input type="file" id="ungpFileInput" name="attachment" style="display: none;" onchange="document.getElementById('ungpFileName').textContent = this.files[0]?.name || 'No file selected.'">
                </div>
              </details>
            </div>

            <div class="form-actions" style="display: flex; gap: 12px; justify-content: flex-start;">
              <button type="button" class="action-button" onclick="goToDashboard()" 
                      style="background: #e2e8f0; color: #64748b; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Back</button>
              <button type="submit" class="action-button save-btn" 
                      style="background: #0d9488; color: white; padding: 10px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer;">Save</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Fire Safety Tab -->
    <div id="tab-fire" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üî• Fire Safety & Protection - Unified Safety and Compliance Checklist</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('fire')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="fire-form" class="form-container">
          <form id="fireFormData" onsubmit="saveFireSafetyTab(event)" method="post" action="">
            <h3 style="color: #0ea5e9; margin-bottom: 16px;">üî• Fire Safety & Protection - Smoking Cabins</h3>
            
            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Smoking prohibited inside all buildings</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="smokingProhibited" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="smokingProhibited" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="smokingProhibited" value="N/A" style="width: 14px; height: 14px;" checked> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>"No Smoking" signs in Urdu & English posted at entrances</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noSmokingSigns" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="noSmokingSigns" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="noSmokingSigns" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Designated outdoor smoking areas provided, and clearly marked (if applicable)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="outdoorSmokingAreas" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="outdoorSmokingAreas" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="outdoorSmokingAreas" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Microstanding policy in writing with regular cleaning schedule</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="microstandingPolicy" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="microstandingPolicy" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="microstandingPolicy" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Room, walls, ceilings, ventilation cleaned to avoid fire/dust accumulation</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="roomCleaned" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="roomCleaned" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="roomCleaned" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Egress paths kept clear and unobstructed</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="egressPathsClear" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="egressPathsClear" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="egressPathsClear" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Daily inspection for egress, fire doors, storage, fire work, smoking compliance</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="dailyInspection" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="dailyInspection" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="dailyInspection" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Fire exits tested for safe/speedy exit/latching</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireExitsTested" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireExitsTested" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireExitsTested" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 24px 0 16px 0;">üî• Fire Safety & Protection - Exits & Evacuation</h3>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>No blockage and doors in production areas</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noBlockage" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="noBlockage" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="noBlockage" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Only swinging doors in production, stilling doors only in offices/stores/labs (< 10 persons)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="swingingDoors" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="swingingDoors" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="swingingDoors" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Exit capacity meets applicable code requirements</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="exitCapacity" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="exitCapacity" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="exitCapacity" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Exits discharge plan includes guidance for disabled persons (per NFPA 2009)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="exitDischargePlan" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="exitDischargePlan" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="exitDischargePlan" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 24px 0 16px 0;">üî• Fire Safety & Protection - Sprinklers & Hose</h3>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Factory follows NFPA fire protection standards</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="followsNFPA" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="followsNFPA" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="followsNFPA" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Factory classifies correctly by occupancy type / industrial / ordinary / hazard</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="classifiedCorrectly" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="classifiedCorrectly" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="classifiedCorrectly" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Automatic sprinklers installed on floors ‚â• 30 ft above fire-truck access</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersInstalled" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersInstalled" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersInstalled" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Underground car parks equipped with sprink ler compliant operation</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="undergroundSprinklers" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="undergroundSprinklers" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="undergroundSprinklers" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>All sprinkler systems must meet NFPA 13</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersMeetNFPA" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersMeetNFPA" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersMeetNFPA" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Sprinklers inspected & maintained per NFPA 25</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Evacuation plan available in accordance for disabled person (per NFPA 2009)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationPlan" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationPlan" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationPlan" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Instruction maps posted at exits and sidewalls</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="instructionMapsPosted" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="instructionMapsPosted" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="instructionMapsPosted" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Evacuation plan meets guidance for disabled person (per NFPA 72)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationMeetsGuidance" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationMeetsGuidance" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationMeetsGuidance" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Evacuation maps posted as per local fire regulations (per NFPA 101)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationMapsRegulations" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationMapsRegulations" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationMapsRegulations" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Emergency lights installed to operate the fire-safety plan (e.g., safety, rescue, inspection, fire-testing, pre-departure and testing terminally)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="emergencyLightsInstalled" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="emergencyLightsInstalled" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="emergencyLightsInstalled" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Fire doors (as constructed at least twice a year (from fire inspectors/complaints/persons), with additional inspections performed during construction activities</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireDoorsInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireDoorsInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireDoorsInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Quarterly safety inspections conducted by a designated competent person</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="quarterlySafetyInspections" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="quarterlySafetyInspections" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="quarterlySafetyInspections" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Fire exits may be conducted at least twice a year from the designated compliance persons performed during construction activities</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireExitsInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireExitsInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireExitsInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Trained professional assigned to monitor building, loading, materials, equipment</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="trainedProfessional" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="trainedProfessional" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="trainedProfessional" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>All fire-extinguisher tested & inspected adequately, per code requirements</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="extinguishersTested" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="extinguishersTested" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="extinguishersTested" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>No combustion stored near cutting tables</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noCombustionStored" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="noCombustionStored" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="noCombustionStored" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Hint-work permit system in place (per year AHJ)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="hintWorkPermit" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="hintWorkPermit" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="hintWorkPermit" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Complex structural documentation available on site</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="structuralDocumentation" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="structuralDocumentation" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="structuralDocumentation" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>Air-built documentation prepared where original missing</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="airbuiltDocumentation" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="airbuiltDocumentation" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="airbuiltDocumentation" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 20px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f8fafc; border-radius: 8px;">
                <span>All multi-story buildings have fire-escape equipment/exterior stairwells</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="multistoryFireEscape" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="multistoryFireEscape" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="multistoryFireEscape" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('fireFormData')">üîÑ Reset</button>
            </div>
          </form>
        </div>
        <div id="fire-table" class="data-table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Location</th>
                <th>Equipment</th>
                <th>Status</th>
                <th>Inspector</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="fire-table-body">
              <tr><td colspan="7" style="text-align:center; padding:20px;">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Electrical Tab -->
    <div id="tab-electrical" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>‚ö° ELECTRICAL SYSTEM COMPLIANCE CHECKLIST</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('electrical')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="electrical-form" class="form-container" style="padding: 16px;">
          <form id="electricalFormData" onsubmit="saveElectrical(event)">
            <div style="margin-bottom: 24px;">
              <h3 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">Basic Information</h3>
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Inspection Date *</label>
                  <input type="date" name="inspectionDate" required style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Location/Building *</label>
                  <input type="text" name="location" required style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Floor/Area</label>
                  <input type="text" name="floorArea" style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Inspector Name *</label>
                  <input type="text" name="inspectorName" required style="font-size: 13px; padding: 6px;">
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">1. ELECTRICAL PANELS & DISTRIBUTION</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">1.1 Main electrical panel accessible and properly labeled</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_accessible" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_accessible" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_accessible" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">1.2 Circuit breakers properly labeled and functional</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="breakers_labeled" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="breakers_labeled" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="breakers_labeled" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">1.3 No unauthorized modifications to electrical panels</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_modifications" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_modifications" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_modifications" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">1.4 Panel doors secure and not damaged</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_doors" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_doors" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="panel_doors" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">1.5 Minimum 3-foot clearance around electrical panels</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="clearance_3ft" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="clearance_3ft" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="clearance_3ft" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">2. WIRING & CONDUITS</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">2.1 All wiring properly secured and supported</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="wiring_secured" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="wiring_secured" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="wiring_secured" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">2.2 No exposed or damaged wiring</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_exposed_wiring" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_exposed_wiring" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_exposed_wiring" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">2.3 Conduits properly installed and grounded</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduits_grounded" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduits_grounded" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduits_grounded" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">2.4 No temporary wiring or extension cords as permanent solutions</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_temp_wiring" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_temp_wiring" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_temp_wiring" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">2.5 Junction boxes covered and accessible</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="junction_covered" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="junction_covered" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="junction_covered" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">3. GROUNDING & BONDING</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">3.1 All electrical equipment properly grounded</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="equipment_grounded" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="equipment_grounded" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="equipment_grounded" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">3.2 Grounding conductors properly sized and connected</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conductors_sized" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conductors_sized" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conductors_sized" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">3.3 Metal conduit systems bonded to ground</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduit_bonded" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduit_bonded" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="conduit_bonded" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">4. OUTLETS & SWITCHES</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">4.1 All outlets have proper cover plates</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="outlets_covered" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="outlets_covered" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="outlets_covered" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">4.2 GFCI protection in wet locations (kitchens, bathrooms, outdoor)</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="gfci_wet" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="gfci_wet" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="gfci_wet" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">4.3 No loose or damaged outlets/switches</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_loose_outlets" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_loose_outlets" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_loose_outlets" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">4.4 Three-prong grounded outlets where required</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="three_prong" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="three_prong" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="three_prong" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">5. EMERGENCY SYSTEMS</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">5.1 Emergency lighting functional and properly installed</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_lighting" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_lighting" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_lighting" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">5.2 Exit signs illuminated and visible</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exit_signs" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exit_signs" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exit_signs" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">5.3 Emergency power systems tested and operational</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_power" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_power" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_power" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">6. EQUIPMENT & MACHINERY</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">6.1 All motors and equipment properly grounded</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="motors_grounded" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="motors_grounded" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="motors_grounded" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">6.2 Disconnect switches accessible and marked</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="disconnect_accessible" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="disconnect_accessible" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="disconnect_accessible" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">6.3 Equipment nameplates readable and intact</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplates_readable" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplates_readable" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplates_readable" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">7. ADDITIONAL NOTES & ACTIONS</h3>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Deficiencies/Observations</label>
                <textarea name="deficiencies" rows="3" style="font-size: 13px; padding: 6px;" placeholder="List any deficiencies or observations"></textarea>
              </div>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Corrective Actions Required</label>
                <textarea name="correctiveActions" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Specify corrective actions needed"></textarea>
              </div>

              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Overall Status</label>
                  <select name="status" style="font-size: 13px; padding: 6px;">
                    <option value="Compliant">Compliant</option>
                    <option value="Non-Compliant">Non-Compliant</option>
                    <option value="Needs Attention">Needs Attention</option>
                    <option value="Critical">Critical</option>
                  </select>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Follow-up Date</label>
                  <input type="date" name="followupDate" style="font-size: 13px; padding: 6px;">
                </div>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('electricalFormData')">üîÑ Reset</button>
            </div>
          </form>
        <div id="electrical-table" class="data-table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Location</th>
                <th>Equipment</th>
                <th>Voltage</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="electrical-table-body">
              <tr><td colspan="7" style="text-align:center; padding:20px;">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Structural Tab -->
    <div id="tab-structural" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üèóÔ∏è Structural Safety Inspections</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('structural')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="structural-form" class="form-container">
          <form id="structuralFormData" onsubmit="saveStructural(event)">
            <div class="form-grid">
              <div class="form-group">
                <label>Inspection Date *</label>
                <input type="datetime-local" name="inspectionDate" required>
              </div>
              <div class="form-group">
                <label>Location *</label>
                <input type="text" name="location" required>
              </div>
              <div class="form-group">
                <label>Structure Type</label>
                <select name="structureType">
                  <option value="">Select Type</option>
                  <option value="Building">Building</option>
                  <option value="Warehouse">Warehouse</option>
                  <option value="Bridge">Bridge</option>
                  <option value="Staircase">Staircase</option>
                  <option value="Platform">Platform</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="form-group">
                <label>Floor Condition</label>
                <select name="floorCondition">
                  <option value="">Select Condition</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good">Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="Critical">Critical</option>
                </select>
              </div>
              <div class="form-group">
                <label>Wall Condition</label>
                <select name="wallCondition">
                  <option value="">Select Condition</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good">Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="Critical">Critical</option>
                </select>
              </div>
              <div class="form-group">
                <label>Ceiling Condition</label>
                <select name="ceilingCondition">
                  <option value="">Select Condition</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good">Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="Critical">Critical</option>
                </select>
              </div>
              <div class="form-group">
                <label>Staircase Condition</label>
                <select name="staircaseCondition">
                  <option value="">Select Condition</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good">Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="N/A">N/A</option>
                </select>
              </div>
              <div class="form-group">
                <label>Railings Secure? *</label>
                <div class="radio-group">
                  <label><input type="radio" name="railingsSecure" value="Yes" required> Yes</label>
                  <label><input type="radio" name="railingsSecure" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="railingsSecure" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </div>
              <div class="form-group">
                <label>Cracks Visible? *</label>
                <div class="radio-group">
                  <label><input type="radio" name="cracksVisible" value="Yes" required> Yes</label>
                  <label><input type="radio" name="cracksVisible" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>
              <div class="form-group">
                <label>Water Leakage? *</label>
                <div class="radio-group">
                  <label><input type="radio" name="waterLeakage" value="Yes" required> Yes</label>
                  <label><input type="radio" name="waterLeakage" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>
              <div class="form-group">
                <label>Load Bearing Capacity</label>
                <select name="loadBearingCapacity">
                  <option value="">Select Status</option>
                  <option value="Adequate">Adequate</option>
                  <option value="Marginal">Marginal</option>
                  <option value="Insufficient">Insufficient</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="form-group">
                <label>Inspected By</label>
                <input type="text" name="inspectedBy">
              </div>
              <div class="form-group full-width">
                <label>Deficiencies</label>
                <textarea name="deficiencies" rows="3" placeholder="List any structural deficiencies found"></textarea>
              </div>
              <div class="form-group full-width">
                <label>Corrective Actions</label>
                <textarea name="correctiveActions" rows="3" placeholder="Describe repairs or maintenance required"></textarea>
              </div>
              <div class="form-group">
                <label>Status</label>
                <select name="status">
                  <option value="Safe">Safe</option>
                  <option value="Needs Monitoring">Needs Monitoring</option>
                  <option value="Repair Required">Repair Required</option>
                  <option value="Unsafe">Unsafe</option>
                  <option value="Condemned">Condemned</option>
                </select>
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('structuralFormData')">üîÑ Reset</button>
            </div>
          </form>
        </div>
        <div id="structural-table" class="data-table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Location</th>
                <th>Structure Type</th>
                <th>Status</th>
                <th>Inspector</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="structural-table-body">
              <tr><td colspan="7" style="text-align:center; padding:20px;">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- USC-Safe Tab -->
    <div id="tab-usc-safe" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üìã USC-Safe - Unified Safety and Compliance Checklist</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('usc-safe')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="usc-safe-form" class="form-container" style="padding: 16px;">
          <form id="uscSafeFormData" onsubmit="saveUSCSafe(event)">
            
            <!-- Fire Safety & Protection ‚Äì Smoking Controls -->
            <h3 style="color: #0ea5e9; margin-bottom: 12px; font-size: 15px; font-weight: 600;">üî• Fire Safety & Protection ‚Äì Smoking Controls</h3>
            
            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Smoking prohibited inside all buildings</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="smoking_prohibited" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="smoking_prohibited" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="smoking_prohibited" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">"No Smoking" signs in Urdu & English posted at entrances</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="no_smoking_signs" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="no_smoking_signs" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="no_smoking_signs" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Designated outdoor smoking areas provided and clearly marked (if applicable)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="outdoor_smoking" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="outdoor_smoking" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="outdoor_smoking" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <!-- Fire Safety & Protection ‚Äì Housekeeping & Egress -->
            <h3 style="color: #0ea5e9; margin: 20px 0 12px 0; font-size: 15px; font-weight: 600;">üî• Fire Safety & Protection ‚Äì Housekeeping & Egress</h3>
            
            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Housekeeping policy in writing with regular cleaning schedule</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="housekeeping_policy" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="housekeeping_policy" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="housekeeping_policy" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Floors, walls, ceilings, ventilation cleaned to avoid lint/dust accumulation</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="cleaning_lint" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="cleaning_lint" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="cleaning_lint" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Egress paths kept clear and unobstructed</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="egress_clear" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="egress_clear" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="egress_clear" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Daily inspections for egress, fire doors, storage, hot-work, smoking compliance</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="daily_inspections" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="daily_inspections" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="daily_inspections" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Fire doors tested for self-closing and latching</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="fire_doors_tested" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="fire_doors_tested" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="fire_doors_tested" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <!-- Fire Safety & Protection ‚Äì Exits & Evacuation -->
            <h3 style="color: #0ea5e9; margin: 20px 0 12px 0; font-size: 15px; font-weight: 600;">üî• Fire Safety & Protection ‚Äì Exits & Evacuation</h3>
            
            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">No lockable exit doors in production areas</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="no_lockable_exits" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="no_lockable_exits" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="no_lockable_exits" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Only swinging doors in production; sliding doors only in offices/admin (&lt;10 persons)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="swinging_doors" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="swinging_doors" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="swinging_doors" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Exit capacity meets applicable code requirements</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="exit_capacity" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="exit_capacity" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="exit_capacity" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 8px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f8fafc; border-radius: 6px;">
                <span style="font-size: 13px;">Exits discharge directly to exterior or protected by fire-rated separation + sprinklers</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 12px;"><input type="radio" name="exits_discharge" value="Yes"> Yes</label>
                  <label style="font-size: 12px;"><input type="radio" name="exits_discharge" value="No"> No</label>
                  <label style="font-size: 12px;"><input type="radio" name="exits_discharge" value="N/A"> N/A</label>
                </div>
              </label>
            </div>

            <!-- (Additional USC-Safe sections truncated for brevity ‚Äì they remain in file) -->

            <div class="form-actions" style="margin-top: 24px;">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('uscSafeFormData')">üîÑ Reset</button>
              <button type="button" class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Health Hazards Tab -->
    <div id="tab-health" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>‚ö†Ô∏è Health Hazard Assessment</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('usc-safe')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="usc-safe-form" class="form-container" style="padding: 16px;">
          <form id="uscSafeFormData" onsubmit="saveUSCSafe(event)">
            <h3 style="color: #0ea5e9; margin-bottom: 8px; font-size: 14px; font-weight: 600;">üî• Fire Safety & Protection - Smoking Cabins</h3>
            
            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Smoking prohibited inside all buildings</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="smokingProhibited" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="smokingProhibited" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="smokingProhibited" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">"No Smoking" signs in Urdu & English posted at entrances</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noSmokingSigns" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="noSmokingSigns" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="noSmokingSigns" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Designated outdoor smoking areas provided, and clearly marked (if applicable)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="outdoorSmokingAreas" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="outdoorSmokingAreas" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="outdoorSmokingAreas" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Microstanding policy in writing with regular cleaning schedule</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="microstandingPolicy" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="microstandingPolicy" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="microstandingPolicy" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Room, walls, ceilings, ventilation cleaned to avoid fire/dust accumulation</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="roomCleaned" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="roomCleaned" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="roomCleaned" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Egress paths kept clear and unobstructed</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="egressPathsClear" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="egressPathsClear" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="egressPathsClear" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Daily inspection for egress, fire doors, storage, fire work, smoking compliance</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="dailyInspection" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="dailyInspection" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="dailyInspection" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Fire exits tested for safe/speedy exit/latching</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireExitsTested" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireExitsTested" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireExitsTested" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 12px 0 8px 0; font-size: 14px; font-weight: 600;">üî• Fire Safety & Protection - Exits & Evacuation</h3>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">No blockage and doors in production areas</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noBlockage" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="noBlockage" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="noBlockage" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Only swinging doors in production, stilling doors only in offices/stores/labs (< 10 persons)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="swingingDoors" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="swingingDoors" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="swingingDoors" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Exit capacity meets applicable code requirements</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="exitCapacity" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="exitCapacity" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="exitCapacity" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Exits discharge plan includes guidance for disabled persons (per NFPA 2009)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="exitDischargePlan" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="exitDischargePlan" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="exitDischargePlan" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 12px 0 8px 0; font-size: 14px; font-weight: 600;">üî• Fire Safety & Protection - Sprinklers & Hose</h3>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Factory follows NFPA fire protection standards</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="followsNFPA" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="followsNFPA" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="followsNFPA" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Factory classifies correctly by occupancy type / industrial / ordinary / hazard</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="classifiedCorrectly" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="classifiedCorrectly" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="classifiedCorrectly" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Automatic sprinklers installed on floors ‚â• 30 ft above fire-truck access</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersInstalled" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersInstalled" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersInstalled" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Underground car parks equipped with sprink ler compliant operation</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="undergroundSprinklers" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="undergroundSprinklers" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="undergroundSprinklers" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">All sprinkler systems must meet NFPA 13</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersMeetNFPA" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersMeetNFPA" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersMeetNFPA" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Sprinklers inspected & maintained per NFPA 25</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="sprinklersInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="sprinklersInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="sprinklersInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Evacuation plan available in accordance for disabled person (per NFPA 2009)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationPlan" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationPlan" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationPlan" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Instruction maps posted at exits and sidewalls</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="instructionMapsPosted" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="instructionMapsPosted" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="instructionMapsPosted" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Evacuation plan meets guidance for disabled person (per NFPA 72)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationMeetsGuidance" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationMeetsGuidance" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationMeetsGuidance" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Evacuation maps posted as per local fire regulations (per NFPA 101)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="evacuationMapsRegulations" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="evacuationMapsRegulations" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="evacuationMapsRegulations" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Emergency lights installed to operate the fire-safety plan</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="emergencyLightsInstalled" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="emergencyLightsInstalled" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="emergencyLightsInstalled" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Fire doors inspected at least twice a year with additional inspections during construction</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireDoorsInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireDoorsInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireDoorsInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Quarterly safety inspections conducted by a designated competent person</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="quarterlySafetyInspections" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="quarterlySafetyInspections" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="quarterlySafetyInspections" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Fire exits conducted at least twice a year from designated compliance persons</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireExitsInspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="fireExitsInspected" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="fireExitsInspected" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Trained professional assigned to monitor building, loading, materials, equipment</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="trainedProfessional" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="trainedProfessional" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="trainedProfessional" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">All fire-extinguisher tested & inspected adequately, per code requirements</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="extinguishersTested" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="extinguishersTested" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="extinguishersTested" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">No combustion stored near cutting tables</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="noCombustionStored" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="noCombustionStored" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="noCombustionStored" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Hot-work permit system in place (per year AHJ)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="hotWorkPermit" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="hotWorkPermit" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="hotWorkPermit" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Complex structural documentation available on site</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="structuralDocumentation" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="structuralDocumentation" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="structuralDocumentation" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">As-built documentation prepared where original missing</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="asBuiltDocumentation" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="asBuiltDocumentation" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label><input type="radio" name="asBuiltDocumentation" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">All multi-story buildings have fire-escape equipment/exterior stairwells</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="multistoryFireEscape" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label><input type="radio" name="multistoryFireEscape" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="multistoryFireEscape" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 12px 0 8px 0; font-size: 14px; font-weight: 600;">üî• FIRE SAFETY THIRD-PARTY CERTIFICATION COMPLIANCE CHECKLIST</h3>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Spec / Equipment: Fire Alarm & Notification / Elevator</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireAlarmNotification" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="fireAlarmNotification" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="fireAlarmNotification" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Fire Doors: UL fire-Damping manual; passing threshold in accredited fire/safety testing</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="fireDoorsCertified" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="fireDoorsCertified" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="fireDoorsCertified" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">UL / FM / Intertek / Equivalent third party fire (& Safety door Certificate (ICC, UL Certified, or Equivalent third party testing</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="thirdPartyCertified" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="thirdPartyCertified" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="thirdPartyCertified" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">UL / FM / IFC / UCS components (SMACNA, IEC, CSA, Seismic static ASTM, ANSI, ASHRAE, NFPA or Equivalent 3 party testing certified</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="componentsCertified" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="componentsCertified" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="componentsCertified" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">UL / FM / Intertek / Equivalent

As per UL Fire Test file Rated fire list by UL recognized fire rated certifications (< 10 people)</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="ulFireRated" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="ulFireRated" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="ulFireRated" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 12px 0 8px 0; font-size: 14px; font-weight: 600;">A) FIRE TEST ‚Äî DOCUMENT REVIEW</h3>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Installation certificate & records of completion on site ‚Äî NFPA 3 ch3, NFPA 4 ch2</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="installationCertificate" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="installationCertificate" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="installationCertificate" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Approved air built drawing (match field conditions ‚Äî NFPA 3 ch2</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="approvedDrawing" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="approvedDrawing" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="approvedDrawing" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Product data & listing (along listing on NFPA72) for all components ‚Äî NFPA 3 ch4, NFPA 4 ch4</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="productDataListing" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="productDataListing" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="productDataListing" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Battery capacity suitablyacceptance document ‚Äî NFPA 3 NFPA ch4</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="batteryCapacity" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="batteryCapacity" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="batteryCapacity" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Manufacturer's installation manuals available for all listed equipment ‚Äî NFPA 3 ch4</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="manufacturerManuals" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="manufacturerManuals" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="manufacturerManuals" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Battery reports & strategy shop acceptance documents published ‚Äî NFPA 3 NFPA ch4</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="batteryReports" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="batteryReports" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="batteryReports" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <h3 style="color: #0ea5e9; margin: 12px 0 8px 0; font-size: 14px; font-weight: 600;">E) POST-TEST & HANDOVER</h3>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">All defects noted from factory commissioning/ testing and restoration / witness test‚ÄîNFPA 72 ch2 ‚Äî NFPA 4 ch2</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="defectsNoted" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="defectsNoted" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="defectsNoted" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Firefighter key export (special broadcast) (... owner opt / ALL) ‚Äî NFPA 72 ch4, NFPA 4 ch2</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="firefighterKeyExport" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="firefighterKeyExport" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="firefighterKeyExport" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">Operators on audio & their manual selections / notices / ALL! ‚Äî NFPA 72 ch2</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="operatorAudioManual" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="operatorAudioManual" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="operatorAudioManual" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-group full-width" style="margin-bottom: 4px;">
              <label style="display: flex; justify-content: space-between; align-items: center; padding: 4px 8px; background: #f8fafc; border-radius: 4px;">
                <span style="font-size: 12px;">3 existing building/existing space ‚Äî special exception ‚Äî NFPA 4 ch7.4.1</span>
                <div class="radio-group" style="margin: 0; gap: 10px;">
                  <label style="font-size: 11px;"><input type="radio" name="existingBuildingException" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="font-size: 11px;"><input type="radio" name="existingBuildingException" value="No" style="width: 14px; height: 14px;"> No</label>
                  <label style="font-size: 11px;"><input type="radio" name="existingBuildingException" value="N/A" style="width: 14px; height: 14px;"> N/A</label>
                </div>
              </label>
            </div>

            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('uscSafeFormData')">üîÑ Reset</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Health Hazards Tab -->
    <div id="tab-health" class="tab-content">
      <div style="padding: 24px;">
        <div class="dashboard-card">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>‚ö†Ô∏è Health Hazard Assessment</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('health')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="health-form" class="form-container" style="padding: 16px;">
          <form id="healthFormData" onsubmit="saveHealth(event)">
            
            <!-- Basic Information -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 12px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">Basic Information</h3>
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px;">Assessment Date *</label>
                  <input type="date" name="assessmentDate" required style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px;">Location *</label>
                  <input type="text" name="location" required style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px;">Factory ID</label>
                  <input type="text" name="factoryId" style="font-size: 13px; padding: 6px;">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px;">Assessed By *</label>
                  <input type="text" name="assessedBy" required style="font-size: 13px; padding: 6px;">
                </div>
              </div>
            </div>

            <!-- CHEMICAL HAZARDS -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">CHEMICAL HAZARDS</h3>
              
              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Chemical 1</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Type</label>
                <input type="text" name="chemical1_type" placeholder="Chemical type/name" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Chemical signs used</label>
                <input type="text" name="chemical1_signs" placeholder="Signs/labels used" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Hazardous properties</label>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_allergic" style="width: 14px; height: 14px;"> Allergic reactions</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_toxic" style="width: 14px; height: 14px;"> Toxic</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_flammable" style="width: 14px; height: 14px;"> Flammable</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_corrosive" style="width: 14px; height: 14px;"> Corrosive</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_irritating" style="width: 14px; height: 14px;"> Irritating</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_environmental" style="width: 14px; height: 14px;"> Environmental hazard</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_harmful" style="width: 14px; height: 14px;"> Harmful</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="chemical1_sensitizing" style="width: 14px; height: 14px;"> Sensitizing substances</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Storage location</label>
                <input type="text" name="chemical1_storage" placeholder="Storage location" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Expiry Date</label>
                <input type="text" name="chemical1_expiry" placeholder="MM / DD / YYYY" style="width: 200px; font-size: 12px; padding: 4px;">
              </div>

              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">General Precautions</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Special precautions</label>
                <textarea name="chemical_precautions" rows="2" placeholder="List special precautions" style="width: 100%; font-size: 12px; padding: 4px;"></textarea>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Control measures for handling, storing, labeling, and disposal of chemicals</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="control_measures" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="control_measures" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>
            </div>

            <!-- PHYSICAL HAZARDS -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">PHYSICAL HAZARDS</h3>
              
              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Machine 1</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Machine Name</label>
                <input type="text" name="machine1_name" placeholder="Machine name" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Are basest protective equipment (PPE) provided to workers according to machine type?</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="machine1_ppe" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="machine1_ppe" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Training Frequency</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Training frequency:</label>
                <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-top: 4px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="radio" name="training_freq" value="Monthly" style="width: 14px; height: 14px;"> Monthly</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="radio" name="training_freq" value="Quarterly" style="width: 14px; height: 14px;"> Quarterly</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="radio" name="training_freq" value="Bimonthly" style="width: 14px; height: 14px;"> Bimonthly</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="radio" name="training_freq" value="NoSelection" style="width: 14px; height: 14px;"> No Selection</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Upload Training plan</label>
                <input type="file" name="training_plan" style="font-size: 12px;">
              </div>
            </div>

            <!-- BIOLOGICAL HAZARDS -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">BIOLOGICAL HAZARDS</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Pathogen assessment</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="pathogen_assessment" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="pathogen_assessment" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">If the particular workers has the exposure to:">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="bio_infectious" style="width: 14px; height: 14px;"> Infectious disease</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="bio_body_fluids" style="width: 14px; height: 14px;"> Body fluids or cell due work</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="bio_salmonella" style="width: 14px; height: 14px;"> Salmonella</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Specify the Pathogens workers may be exposed to:</label>
                <textarea name="bio_pathogens" rows="2" placeholder="List pathogens" style="width: 100%; font-size: 12px; padding: 4px;"></textarea>
              </div>

              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Preventive Measures</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Click the boxes below for preventing exposure to pathogens:</label>
                <div style="display: grid; grid-template-columns: 1fr; gap: 6px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="prevent_handwash" style="width: 14px; height: 14px;"> Providing areas to clean and hands and bodies workspace/equipment, and clothing after work</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="prevent_facilities" style="width: 14px; height: 14px;"> Properly Setting self-help facilities (like food providing areas and rest areas)</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="prevent_training" style="width: 14px; height: 14px;"> Regularly training workers on work-related health hazards and providing the same of those who to prevent and symptoms or illness that might potentially occur</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="prevent_ventilation" style="width: 14px; height: 14px;"> Developing an emergency plan to manage outbreaks of illness or disease in the workplace</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="prevent_first_aid" style="width: 14px; height: 14px;"> Providing first aid or medical assistance if anyone becomes ill at the workplace</label>
                </div>
              </div>
            </div>

            <!-- ERGONOMIC HAZARDS -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">ERGONOMIC HAZARDS</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Mitigation measures</label>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="ergo_rotation" style="width: 14px; height: 14px;"> Job rotation</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="ergo_breaks" style="width: 14px; height: 14px;"> Provide workers rest time</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="ergo_design" style="width: 14px; height: 14px;"> Ergonomic workstation design</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="ergo_lift_aid" style="width: 14px; height: 14px;"> Lift aid and angle assist</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="ergo_conveyor" style="width: 14px; height: 14px;"> Conveyor system or trolleys to move heavy objects</label>
                </div>
              </div>

              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Workstation setup</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Monitor height and distance</label>
                <input type="text" name="ergo_monitor" placeholder="Monitor setup details" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>
            </div>

            <!-- DUST AND FIBER HAZARDS ASSESSMENT -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">DUST AND FIBER HAZARDS ASSESSMENT</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Select types of hazardous dust and fiber present at your factory</label>
                <div style="display: grid; grid-template-columns: 1fr; gap: 6px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_cotton" style="width: 14px; height: 14px;"> Cotton Dust</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_wood" style="width: 14px; height: 14px;"> Wood Dust</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_silica" style="width: 14px; height: 14px;"> Silica Dust</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_asbestos" style="width: 14px; height: 14px;"> Asbestos Fiber</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_nano" style="width: 14px; height: 14px;"> Nano Dust</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Ambient pollution</label>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_fiber_ambient" style="width: 14px; height: 14px;"> Fiber pollution within work areas</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_fumes" style="width: 14px; height: 14px;"> Fumes</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_vehicle" style="width: 14px; height: 14px;"> Vehicle pollution</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_coal" style="width: 14px; height: 14px;"> Coal pollution</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_dye_chemical" style="width: 14px; height: 14px;"> Dye and chemical system</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_indoor_air" style="width: 14px; height: 14px;"> Indoor air quality evaluation</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_sandblasting" style="width: 14px; height: 14px;"> Sandblasting or shot peening equipment</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="dust_spray" style="width: 14px; height: 14px;"> Spray booth/spray painting</label>
                </div>
              </div>
            </div>

            <!-- HEAT STRESS HAZARD ASSESSMENT -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">HEAT STRESS HAZARD ASSESSMENT</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Temperature monitoring:</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_temperature" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_temperature" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Nation humidity</label>
                <input type="text" name="heat_humidity" placeholder="Humidity level" style="width: 200px; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Thermometer Location</label>
                <input type="text" name="heat_therm_location" placeholder="Location" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <h4 style="margin: 12px 0 8px 0; font-size: 13px; font-weight: 600; color: #475569;">Heat stress parameters</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Dry Thermometer Location</label>
                <input type="text" name="heat_dry_therm" placeholder="Location" style="width: 100%; font-size: 12px; padding: 4px;">
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Note on all rest time of stress and the symptoms of heat stress and heat-borne illnesses are brought to the Workers</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_awareness" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_awareness" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Do employees receive a rest and first heat regular during the heat of the day (1-4 pm)?</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_breaks" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="heat_breaks" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Explaning controls that the break equipment / Heat-adapted Equipment / Protective Equipment will need / Other equipment treatment</label>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 6px;">
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_ceiling_fan" style="width: 14px; height: 14px;"> Ceiling Fan / table fans / pedestal fans</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_water" style="width: 14px; height: 14px;"> Potable Cooling water</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_shelter" style="width: 14px; height: 14px;"> Cooling facility / shaded rest areas</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_insulation" style="width: 14px; height: 14px;"> Thermal insulation</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_evaporative" style="width: 14px; height: 14px;"> Evaporative Cooler</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_air_cooler" style="width: 14px; height: 14px;"> Air Cooler</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_misting" style="width: 14px; height: 14px;"> Misting fan or spray</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_ac" style="width: 14px; height: 14px;"> Air conditioning</label>
                  <label style="font-size: 11px; display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="heat_ors" style="width: 14px; height: 14px;"> ORS packets available</label>
                </div>
              </div>
            </div>

            <!-- ELECTRICAL HAZARD ASSESSMENT -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8; background: #e8f4fd; padding: 8px 12px; border-radius: 4px;">ELECTRICAL HAZARD ASSESSMENT</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Without Exposure</label>
                <textarea name="electrical_exposure" rows="2" placeholder="Describe exposure details" style="width: 100%; font-size: 12px; padding: 4px;"></textarea>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Single line diagram</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_diagram" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_diagram" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Electrical equipment generated by a designated competent person</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_competent" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_competent" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Electrical systems inspected by an independent qualified electrical engineer</label>
                <div style="display: flex; gap: 16px; font-size: 12px; margin-top: 4px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_inspected" value="Yes" style="width: 14px; height: 14px;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="electrical_inspected" value="No" style="width: 14px; height: 14px;"> No</label>
                </div>
              </div>
            </div>

            <!-- Additional Notes -->
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">Additional Information</h3>
              <div class="form-group full-width">
                <label style="font-size: 13px;">Observations / Notes</label>
                <textarea name="observations" rows="3" placeholder="Additional observations..." style="width: 100%; font-size: 13px; padding: 6px;"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('healthFormData')">üîÑ Reset</button>
            </div>
          </form>
        </div>
        <div id="health-table" class="data-table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Location</th>
                <th>Hazard Type</th>
                <th>Risk Level</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="health-table-body">
              <tr><td colspan="7" style="text-align:center; padding:20px;">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
      </div>
    </div>

    <!-- Gas Safety Tab -->
    <div id="tab-gas" class="tab-content">
      <div style="padding: 24px; background: white;">
        <div class="dashboard-card" style="background: white;">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üî• USE OF LIQUEFIED OR COMPRESSED FLAMMABLE GAS IN FACTORY PREMISES</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('gas')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="gas-form" class="form-container" style="padding: 16px;">
          <form id="gasFormData" onsubmit="saveGas(event)">
            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Worker Safety</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Factory ensures workers' safety against flammable gas cylinders</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="worker_safety" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="worker_safety" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="worker_safety" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Explosion hazard controls in place: proper maintenance, passive fire protection, safe distance maintained</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="explosion_controls" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="explosion_controls" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="explosion_controls" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Prohibited Storage</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Storage or use of LPG/CNG cylinders inside factory buildings is prohibited in line with recognized international fire safety practices</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="prohibited_storage" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="prohibited_storage" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="prohibited_storage" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">NFPA 30 standard is followed for installation, remediation, and maintenance. <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nfpa_standard" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nfpa_standard" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nfpa_standard" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Technical guidance for compliant storage as per recognized international fire safety codes is implemented</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="technical_guidance" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="technical_guidance" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="technical_guidance" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Safe Storage Practices</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">No storage or use of LPG/CNG cylinders inside factory buildings as required by international fire safety standards (e.g., NFPA 58: Liquefied Petroleum Gas Code). <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safe_storage" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safe_storage" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safe_storage" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Transitional Guidance</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">LPG/CNG cylinders may be stored only if all recognized safety guidance and control measures are implemented</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_storage" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_storage" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_storage" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Factories comply with transitional safety measures to ensure risk-free storage and use of cylinders</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_compliance" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_compliance" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="transitional_compliance" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Gas Canister Room</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Gas canister room enclosed with 2-hour fire resistant, non-combustible construction</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="room_enclosed" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="room_enclosed" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="room_enclosed" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Fire doors and protected openings/ducts provided as required by international fire codes</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_doors" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_doors" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_doors" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Previously verified compliant storage rooms do not require further remediation if no alterations have been made</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="verified_compliant" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="verified_compliant" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="verified_compliant" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Ongoing compliance monitored through regular inspections by qualified safety professionals</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ongoing_compliance" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ongoing_compliance" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ongoing_compliance" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Storage Building</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Storage building located at least 3 m away from other buildings or boundaries</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_distance" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_distance" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_distance" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Exterior walls constructed with 3-hour fire resistance, non-combustible materials</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exterior_walls" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exterior_walls" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exterior_walls" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Doors and openings with 3-hour fire protection rating</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="doors_rating" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="doors_rating" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="doors_rating" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Building used solely for cylinder storage</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_sole_use" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_sole_use" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_sole_use" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Adequate mechanical ventilation installed</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ventilation_installed" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ventilation_installed" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="ventilation_installed" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Building approved by relevant Authority Having Jurisdiction (AHJ), gas supply company, manufacturer's guidance, or competent professional bodies</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_approved" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_approved" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="building_approved" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Storage Condition</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinders stored in a dry, cool, well-ventilated area</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_stored_condition" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_stored_condition" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_stored_condition" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinders kept away from ignition sources, electrical equipment, combustibles, corrosives, heat, and dampness</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_away_hazards" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_away_hazards" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_away_hazards" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinder bottoms protected from ground contact</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinder_bottoms_protected" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinder_bottoms_protected" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinder_bottoms_protected" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Labeling & Identification</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Storage area clearly posted with the type of gas stored</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="storage_area_posted" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="storage_area_posted" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="storage_area_posted" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinders clearly labeled with contents and handling precautions</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_labeled" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_labeled" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_labeled" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Full and empty cylinders stored separately</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_separated" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_separated" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_separated" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Valves & Safety Features</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">All cylinders equipped with safety relief valves</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_relief_valves" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_relief_valves" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_relief_valves" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Valves kept closed when not in use</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="valves_closed" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="valves_closed" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="valves_closed" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">No tools or wrenches used to open cylinder valves</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_tools_valves" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_tools_valves" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="no_tools_valves" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Inspection & Testing</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Periodic hydrostatic testing performed by certified suppliers</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="hydrostatic_testing" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="hydrostatic_testing" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="hydrostatic_testing" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinders routinely checked for corrosion, dents, gouges, bulges, or other defects</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_checked" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_checked" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_checked" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Handling & Leaks</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Cylinders moved only with suitable hand trucks</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_moved_trucks" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_moved_trucks" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="cylinders_moved_trucks" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Leaking cylinders tagged as "Unserviceable"</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_tagged" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_tagged" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_tagged" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Leaking cylinders promptly moved to a well-ventilated outdoor location</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_moved" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_moved" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="leaking_moved" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Warning signs posted for leaking cylinders</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="warning_signs_posted" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="warning_signs_posted" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="warning_signs_posted" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Supplier promptly notified and return instructions followed</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="supplier_notified" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="supplier_notified" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="supplier_notified" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #64748b; background: #f1f5f9; padding: 8px 12px; border-radius: 4px;">Inspection & Reporting</h3>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Inspections carried out following recognized international safety protocols for flammable gas storage</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspections_protocols" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspections_protocols" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspections_protocols" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Corrective Action Plans (CAPs) prepared in line with international safety requirements</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="caps_prepared" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="caps_prepared" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="caps_prepared" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 4px;">Inspection reports documented and retained within prescribed timelines (e.g., within 10 working days)</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="reports_documented" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="reports_documented" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="reports_documented" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h3 style="margin: 0 0 10px 0; font-size: 15px; font-weight: 600; color: #1a73e8;">Additional Notes & Attachments</h3>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Observations/Comments</label>
                <textarea name="observations" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Additional observations or notes"></textarea>
              </div>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Corrective Actions Required</label>
                <textarea name="correctiveActions" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Specify any corrective actions needed"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('gasFormData')">üîÑ Reset</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Boiler Safety Tab -->
    <div id="tab-boiler" class="tab-content">
      <div style="padding: 24px; background: white;">
        <div class="dashboard-card" style="background: white;">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>‚öôÔ∏è BOILER SAFETY</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('boiler')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="boiler-form" class="form-container" style="padding: 16px;">
          <form id="boilerFormData" onsubmit="saveBoiler(event)">
            
            <h3 style="margin: 0 0 12px 0; font-size: 16px; font-weight: 600; color: #0ea5e9;">Boiler Safety Programme - Compliance Checklist</h3>
            
            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #64748b;">Requirement</h4>
              
              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">A formal boiler safety programme is established to ensure safe workplaces in manufacturing facilities.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_programme" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_programme" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_programme" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">The factory collaborates with recognized national authorities, accredited inspection bodies, and internationally recognized safety organizations (e.g., ILO occupational safety principles, local boiler inspectorate, and certification bodies, such as NFPA 85 for boiler) for compliance and oversight. <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="factory_collaboration" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="factory_collaboration" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="factory_collaboration" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Boiler design complies with ASME BPVC (Boiler & Pressure Vessel Code) in accordance with ASME Boiler & Pressure Vessel Code (BPVC) Section I and Section VIII and ISO 16528 (Boiler & Pressure Vessel Safety). <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 1)</a> <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 2)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_design" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_design" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_design" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Boiler inspection includes checks for corrosion, leaks, cracks, deposits, scaling, and blockages, in line with ASME BPVC and ISO 16528 guidelines. <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 1)</a> <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 2)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_inspection" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_inspection" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="boiler_inspection" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Boiler inspection verifies the proper function of all safety devices and operational controls (e.g., pressure gauges, safety valves, level indicators).</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspection_verifies" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspection_verifies" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="inspection_verifies" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">The boiler is suitable for rapid depressurization (e.g., for emergencies).</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="rapid_depressurization" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="rapid_depressurization" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="rapid_depressurization" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">The boiler nameplate information (manufacturer, capacity, maximum allowable working pressure, serial number) is clearly visible and matches the boiler's certification documentation.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplate_visible" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplate_visible" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="nameplate_visible" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Fire/hot water outlets are properly sized, maintained, and directed safely outside the building as recommended by ASME BPVC Section I. <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_outlets" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_outlets" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fire_outlets" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">A 'low-low' water level indicator / cutoff device is installed to prevent dry-firing of the boiler.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="low_water_indicator" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="low_water_indicator" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="low_water_indicator" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">A boiler maintenance logbook is maintained: current, and records inspections, repairs, and test results.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="maintenance_logbook" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="maintenance_logbook" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="maintenance_logbook" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Boiler design and parts from manufacturer's manuals are available, complete, and accessible.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="design_manuals" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="design_manuals" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="design_manuals" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">The factory maintains ready access to certified Boiler Safety Engineers / Authorized Inspectors for periodic inspections and technical guidance.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="certified_engineers" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="certified_engineers" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="certified_engineers" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">The factory has a designated Boiler Safety Department staffed with qualified engineers, including a team leader responsible for boiler safety management.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_department" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_department" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_department" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Engineers in charge of boiler operation and maintenance demonstrate appropriate training, certification, and competency in boiler operations.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="engineers_trained" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="engineers_trained" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="engineers_trained" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Advanced training on boiler safety (e.g., in collaboration with accredited boiler schools or technical institutions such as NFPA SMD, Lloyd's Register, or equivalent) is provided to the boiler safety team. <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 1)</a> <a href="#" style="color: #0ea5e9; text-decoration: none;">(Reference 2)</a></label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="advanced_training" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="advanced_training" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="advanced_training" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>

              <div style="margin-bottom: 6px; padding: 6px 0; border-bottom: 1px solid #e0e0e0;">
                <label style="font-size: 13px; font-weight: 400; display: block; margin-bottom: 4px;">Practical/local training on boiler operation and maintenance is provided at certified training centers or by recognized boiler manufacturers to ensure operational safety.</label>
                <div style="display: flex; gap: 16px; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="practical_training" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="practical_training" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="practical_training" value="N/A" style="width: 14px; height: 14px; margin: 0;"> N/A</label>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">WATER SOURCE</h4>
              
              <div style="margin-bottom: 12px;">
                <label style="font-size: 13px; font-weight: 500; display: block; margin-bottom: 6px;">Water Source</label>
                <div style="display: flex; gap: 12px; flex-wrap: wrap; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="water_source" value="Municipal Water" style="width: 14px; height: 14px; margin: 0;"> Municipal Water</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="water_source" value="Well Water" style="width: 14px; height: 14px; margin: 0;"> Well Water</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="water_source" value="Surface Water" style="width: 14px; height: 14px; margin: 0;"> Surface Water</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="water_source" value="Recycled Water" style="width: 14px; height: 14px; margin: 0;"> Recycled Water</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="water_source" value="Condensate" style="width: 14px; height: 14px; margin: 0;"> Condensate</label>
                </div>
              </div>

              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Water storage tank size (Gallons):</label>
                  <input type="number" name="water_storage_tank" style="font-size: 13px; padding: 6px;" placeholder="Enter gallons">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Water softener:</label>
                  <input type="text" name="water_softener" style="font-size: 13px; padding: 6px;" placeholder="Enter details">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler pressure (Kilopascals kPa):</label>
                  <input type="number" name="boiler_pressure" style="font-size: 13px; padding: 6px;" placeholder="Enter kPa">
                </div>
              </div>

              <div class="form-grid" style="gap: 12px; margin-top: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Water level:</label>
                  <input type="text" name="water_level" style="font-size: 13px; padding: 6px;" placeholder="Enter level">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Temperature (Celsius ¬∞C):</label>
                  <input type="number" name="temperature" style="font-size: 13px; padding: 6px;" placeholder="Enter ¬∞C">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Blowdown per day (%):</label>
                  <input type="number" name="blowdown_per_day" step="0.1" style="font-size: 13px; padding: 6px;" placeholder="Enter %">
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">CHEMICAL TREATMENT</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Oxygen scavengers (parts per million ppm):</label>
                  <input type="number" name="oxygen_scavengers" step="0.01" style="font-size: 13px; padding: 6px;" placeholder="Enter ppm">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Corrosion inhibition (parts per billion ppb):</label>
                  <input type="number" name="corrosion_inhibition" style="font-size: 13px; padding: 6px;" placeholder="Enter ppb">
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">WATER QUALITY</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">pH level:</label>
                  <input type="number" name="ph_level" step="0.1" style="font-size: 13px; padding: 6px;" placeholder="Enter pH">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Alkalinity (parts per million ppm):</label>
                  <input type="number" name="alkalinity" style="font-size: 13px; padding: 6px;" placeholder="Enter ppm">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Hardness (parts per million ppm):</label>
                  <input type="number" name="hardness" style="font-size: 13px; padding: 6px;" placeholder="Enter ppm">
                </div>
              </div>

              <div class="form-group" style="margin-top: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">TDS total dissolved solids (parts per million ppm):</label>
                <input type="number" name="tds" style="font-size: 13px; padding: 6px;" placeholder="Enter ppm">
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">BLOWDOWN</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Frequency (per day):</label>
                  <input type="number" name="blowdown_frequency" style="font-size: 13px; padding: 6px;" placeholder="Enter frequency">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Duration of Blowdown (minutes):</label>
                  <input type="number" name="blowdown_duration" style="font-size: 13px; padding: 6px;" placeholder="Enter minutes">
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">STEAM DISTRIBUTION SYSTEM</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Steam header:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_header" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_header" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Steam pressure gauge:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_pressure_gauge" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_pressure_gauge" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Steam traps:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_traps" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_traps" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
              </div>

              <div class="form-grid" style="gap: 12px; margin-top: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Steam control valve:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_control_valve" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_control_valve" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Steam isolation Valve:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_isolation_valve" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="steam_isolation_valve" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">CONDENSATE SYSTEM</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Chimney height (meters):</label>
                  <input type="number" name="chimney_height" step="0.1" style="font-size: 13px; padding: 6px;" placeholder="Enter meters">
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Chimney diameter (millimeters mm):</label>
                  <input type="number" name="chimney_diameter" style="font-size: 13px; padding: 6px;" placeholder="Enter mm">
                </div>
              </div>

              <div class="form-grid" style="gap: 12px; margin-top: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Exhaust fan:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exhaust_fan" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exhaust_fan" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Exhaust duct:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exhaust_duct" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="exhaust_duct" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Stack temperature sensor:</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="stack_temp_sensor" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="stack_temp_sensor" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #0ea5e9;">BOILER SAFETY</h4>
              
              <div class="form-grid" style="gap: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler safety valves installed?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_valves" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="safety_valves" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler pressure gauge installed and calibrated?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="pressure_gauge" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="pressure_gauge" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler low water cutoff device installed?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="low_water_cutoff" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="low_water_cutoff" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
              </div>

              <div class="form-grid" style="gap: 12px; margin-top: 12px;">
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler flame safeguard controls installed and tested?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="flame_safeguard" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="flame_safeguard" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler emergency shut-off switch installed?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_shutoff" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="emergency_shutoff" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
                <div class="form-group">
                  <label style="font-size: 13px; margin-bottom: 4px;">Boiler fuel train safety shut-off valves installed and tested?</label>
                  <div style="display: flex; gap: 12px; font-size: 12px;">
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fuel_train_shutoff" value="Yes" style="width: 14px; height: 14px; margin: 0;"> Yes</label>
                    <label style="display: flex; align-items: center; gap: 4px;"><input type="radio" name="fuel_train_shutoff" value="No" style="width: 14px; height: 14px; margin: 0;"> No</label>
                  </div>
                </div>
              </div>

              <div class="form-group" style="margin-top: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Boiler safety interlock installed and tested:</label>
                <div style="display: flex; gap: 12px; flex-wrap: wrap; font-size: 12px;">
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="interlock_overtemperature" value="Overtemperature" style="width: 14px; height: 14px; margin: 0;"> Overtemperature</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="interlock_low_water" value="Low water" style="width: 14px; height: 14px; margin: 0;"> Low water</label>
                  <label style="display: flex; align-items: center; gap: 4px;"><input type="checkbox" name="interlock_flame_failure" value="Flame failure" style="width: 14px; height: 14px; margin: 0;"> Flame failure</label>
                </div>
              </div>

              <div class="form-group" style="margin-top: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Boiler safety relief valve set pressure (in kilopascals kPa):</label>
                <input type="number" name="relief_valve_pressure" style="font-size: 13px; padding: 6px;" placeholder="Enter kPa">
              </div>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #1a73e8;">Additional Notes & Attachments</h4>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Observations/Comments</label>
                <textarea name="observations" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Additional observations or notes"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="action-button" style="background: #64748b;" onclick="goToDashboard()">Back</button>
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('boilerFormData')">üîÑ Reset Form</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Consultant Engagement Tab -->
    <div id="tab-consultant" class="tab-content">
      <div style="padding: 24px; background: white;">
        <div class="dashboard-card" style="background: white;">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üíº CONSULTANT ENGAGEMENT</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('consultant')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="consultant-form" class="form-container" style="padding: 16px;">
          <form id="consultantFormData" onsubmit="saveConsultant(event)">
            
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
              <span style="font-size: 20px;">üìã</span>
              <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #0f172a;">CONSULTANT ENGAGEMENT ADD-ON CHECKLIST</h3>
            </div>
            
            <div style="margin-bottom: 20px;">
              <table style="width: 100%; border-collapse: collapse; font-size: 13px;">
                <thead>
                  <tr style="background: #f1f5f9; border-bottom: 2px solid #e2e8f0;">
                    <th style="padding: 10px; text-align: left; font-weight: 600; color: #475569;">Section</th>
                    <th style="padding: 10px; text-align: left; font-weight: 600; color: #475569;">Requirement</th>
                    <th style="padding: 10px; text-align: center; font-weight: 600; color: #475569; width: 60px;">Yes</th>
                    <th style="padding: 10px; text-align: center; font-weight: 600; color: #475569; width: 60px;">No</th>
                    <th style="padding: 10px; text-align: center; font-weight: 600; color: #475569; width: 60px;">N/A</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">1. Legal & Professional Standing</td>
                    <td style="padding: 10px; color: #475569;">The consulting firm is a legally registered business entity with a verifiable address and contact details.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="legal_registered" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="legal_registered" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="legal_registered" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">1. Legal & Professional Standing</td>
                    <td style="padding: 10px; color: #475569;">The firm holds valid licenses or registrations required by the jurisdiction of the project location.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="valid_licenses" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="valid_licenses" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="valid_licenses" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">1. Legal & Professional Standing</td>
                    <td style="padding: 10px; color: #475569;">The firm or its professionals maintain relevant international memberships/accreditations (e.g., ASCE, ACI, NFPA, IEED) as indicators of technical credibility.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="international_memberships" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="international_memberships" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="international_memberships" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">2. Integrity & Ethical Practice</td>
                    <td style="padding: 10px; color: #475569;">The consulting firm makes no false or misleading claims of approvals or endorsements by any organization.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="no_false_claims" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="no_false_claims" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="no_false_claims" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">2. Integrity & Ethical Practice</td>
                    <td style="padding: 10px; color: #475569;">The client conducts independent verification of all consultant-provided credentials, certifications, and project references.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="independent_verification" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="independent_verification" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="independent_verification" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">3. Project Team Accountability</td>
                    <td style="padding: 10px; color: #475569;">The consultancy declares the lead engineer and key team members at the time of contract signing.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="declares_team" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="declares_team" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="declares_team" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">3. Project Team Accountability</td>
                    <td style="padding: 10px; color: #475569;">Any change of assigned lead engineer or key staff requires prior consultation and written approval by the client.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="change_approval" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="change_approval" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="change_approval" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">3. Project Team Accountability</td>
                    <td style="padding: 10px; color: #475569;">If portions of work are sub-contracted, the consultancy clearly defines the scope of such work and responsibilities of each party.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="subcontract_scope" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="subcontract_scope" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="subcontract_scope" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">4. Contract & Deliverable Management</td>
                    <td style="padding: 10px; color: #475569;">The scope of work (design, testing oversight, reporting, on-site support) is clearly defined in the contract.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="scope_defined" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="scope_defined" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="scope_defined" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">4. Contract & Deliverable Management</td>
                    <td style="padding: 10px; color: #475569;">The contract sets a reasonable limit on design revisions (e.g., normally up to 3-5) and links payments to client-approved deliverables.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="revision_limit" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="revision_limit" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="revision_limit" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">4. Contract & Deliverable Management</td>
                    <td style="padding: 10px; color: #475569;">The consultant remains engaged through design, implementation, and completion of all required remediation work.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="remains_engaged" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="remains_engaged" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="remains_engaged" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">5. Testing Oversight & Financial Safeguards</td>
                    <td style="padding: 10px; color: #475569;">All field tests and laboratory tests are performed in accredited facilities (e.g., ISO/IEC 17025-accredited labs).</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="accredited_facilities" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="accredited_facilities" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="accredited_facilities" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">5. Testing Oversight & Financial Safeguards</td>
                    <td style="padding: 10px; color: #475569;">Sampling, extraction, and testing activities are supervised or witnessed by the client or its designated representative to ensure validity.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="supervised_testing" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="supervised_testing" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="supervised_testing" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                  
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 10px; font-weight: 500; color: #334155;">5. Testing Oversight & Financial Safeguards</td>
                    <td style="padding: 10px; color: #475569;">The client is not liable for paying for repeat tests caused by the consultant's failure to follow agreed supervision or witnessing protocols.</td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="not_liable_repeat" value="Yes" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="not_liable_repeat" value="No" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                    <td style="padding: 10px; text-align: center;">
                      <input type="radio" name="not_liable_repeat" value="N/A" style="width: 16px; height: 16px; margin: 0;">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #64748b;">Additional Notes & Attachments</h4>
              
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Observations/Comments</label>
                <textarea name="observations" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Additional observations or notes"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="action-button" style="background: #10b981;" onclick="goToDashboard()">Back</button>
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('consultantFormData')">üîÑ Reset Form</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- DSA Tab -->
    <div id="tab-dsa" class="tab-content">
      <div style="padding: 24px; background: white;">
        <div class="dashboard-card" style="background: white;">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üèõÔ∏è DSA - DETAILED STRUCTURAL ASSESSMENT CHECKLIST</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('dsa')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="dsa-form" class="form-container" style="padding: 16px;">
          <form id="dsaFormData" onsubmit="saveDSA(event)">
            
            <h3 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600; color: #0f172a;">DETAILED STRUCTURAL ASSESSMENT CHECKLIST</h3>
            
            <!-- Section 1 -->
            <div style="margin-bottom: 24px;">
              <div style="background: #10b981; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">‚ù∂ 1. Inspection & Documentation</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569; width: 60%;">Verified on bulk drawings, previous design records, soil and geotechnical data are collected and reviewed.</td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="bulk_drawings" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="bulk_drawings" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="bulk_drawings" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Site inspection carried out to identify structural defects such as cracking, deflection, corrosion, settlement or uneven floors.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_inspection" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_inspection" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_inspection" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Visual checks of structural elements (e.g., beams, columns, slabs, walls, foundations) are performed without imposing barriers.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_checks" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_checks" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_checks" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Missing or outdated documentation is flagged, and plans for supplementary investigation are prepared.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="missing_docs" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="missing_docs" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="missing_docs" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Non-destructive or destructive testing (e.g., rebound hammer, core sampling, concrete testing) are conducted where required to confirm material properties.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ndt_testing" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ndt_testing" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ndt_testing" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Section 2 -->
            <div style="margin-bottom: 24px;">
              <div style="background: #10b981; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">‚ù∑ 2. Structural Analysis</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">A complete analytical model is developed to represent structural member load-carrying systems.</td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="analytical_model" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="analytical_model" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center; width: 40px;">
                      <input type="radio" name="analytical_model" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Capacity of columns, beams, slabs, and walls is verified under combined axial, shear, and bending loads using field-verified material strengths.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="capacity_verified" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="capacity_verified" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="capacity_verified" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Redundancy and continuity of load paths are evaluated to minimize the risk of progressive collapse.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="load_paths" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="load_paths" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="load_paths" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Adequacy of the structure to carry its loads is checked based against international codes.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="adequacy_checked" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">Yes</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="adequacy_checked" value="No" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">No</label>
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="adequacy_checked" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                      <label style="font-size: 11px; margin-left: 2px;">N/A</label>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #64748b;">Additional Notes & Attachments</h4>
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Comments</label>
                <textarea name="observations" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Additional observations"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="action-button" style="background: #10b981;" onclick="goToDashboard()">Back</button>
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('dsaFormData')">üîÑ Reset Form</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    <!-- Emergency Power Tab -->
    <div id="tab-emergency-power" class="tab-content">
      <div style="padding: 24px; background: white;">
        <div class="dashboard-card" style="background: white;">
        <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
          <span>üîå EMERGENCY POWER SYSTEM INITIAL DESIGN REVIEW CHECKLIST</span>
          <div style="display: flex; gap: 10px;">
            <button class="action-button export-btn" onclick="exportToExcel('emergency-power')">üìä Export to Excel</button>
            <button class="action-button back-btn" onclick="goToDashboard()">‚Üê Back</button>
          </div>
        </div>
        <div id="emergency-power-form" class="form-container" style="padding: 16px;">
          <form id="emergencyPowerFormData" onsubmit="saveEmergencyPower(event)">
            
            <!-- Section 1: Fire & Life-Safety -->
            <div style="margin-bottom: 24px;">
              <div style="background: #f97316; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">üî• Fire & Life-Safety</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <thead>
                  <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                    <th style="padding: 8px; text-align: left; font-weight: 600; color: #475569; width: 60%;">Requirement</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">Yes</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">No</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">N/A</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Site plan includes fire-department access routes, hydrant locations, roads, underground mains, and reservoir.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_plan" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_plan" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="site_plan" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Means-of-egress layout showing fire-stairwell exits, doors, fixed means, boundary walls, and inter-building distances.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="egress_layout" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="egress_layout" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="egress_layout" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Floor plans indicate standpipes, sprinkler mains, branch piping, hose connections, and fire-rated walls/compartments.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_plans" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_plans" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_plans" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Building elevations & sections included (riser level, prints, floor heights) to verify access and egress.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="elevations" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="elevations" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="elevations" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Roof plan: calculations showing discharge at roof-remediate (uses, pipe lock, ductwork/discharge).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_plan" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_plan" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_plan" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Pump-room construction meets required fire-resistance (e.g., 2-hour rated enclosure or separation per NFPA 20).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_fire_resistance" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_fire_resistance" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_fire_resistance" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Pump-room openlined if containing diesel engine or fuel storage (per NFPA 13).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_openlined" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_openlined" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_openlined" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Pump selection documentation (head, rated flow) complies with NFPA 20 (‚â• 150 % rated flow at ‚â• 65 % head).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_selection" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_selection" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_selection" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Pump-room ventilation designed to maintain temperature ‚â§ 40¬∞C (120¬∞F) with adequate combustion & cooling air.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_ventilation" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_ventilation" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pump_room_ventilation" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Drainage / sump provided for picking-spilled, relief-valve and test discharges.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="drainage_sump" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="drainage_sump" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="drainage_sump" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Clearances in pump-room allow safe access, operation, and maintenance.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clearances" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clearances" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clearances" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Drivers, controllers, valves and other components are listed / approved by recognized testing agencies.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="components_listed" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="components_listed" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="components_listed" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Standard details provided for fire-protection components (valves, meters, test connections, pipe supports).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="standard_details" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="standard_details" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="standard_details" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Fire doors installed for pump-rooms and other rated enclosures, including all certified components (leaf, frame, closer, exit, latches, vision panel).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_doors" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_doors" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_doors" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Fire-pipe sizes, routing, ceiling, numbers, and manufacturer data documented.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pipe_sizes" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pipe_sizes" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="pipe_sizes" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">No combustible materials are stored in pump rooms or in battery and backup-power rooms.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="no_combustibles" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="no_combustibles" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="no_combustibles" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Section 2: Structural & Architectural Safety -->
            <div style="margin-bottom: 24px;">
              <div style="background: #0ea5e9; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">üèóÔ∏è Structural & Architectural Safety</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <thead>
                  <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                    <th style="padding: 8px; text-align: left; font-weight: 600; color: #475569; width: 60%;">Requirement</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">Yes</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">No</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">N/A</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Factory structure verified to support all dead loads (slabs, beams, machinery, batteries, pumps, water tanks).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structure_verified" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structure_verified" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structure_verified" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Structure verified to support all live loads (workers, materials, storage, movement).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="live_loads" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="live_loads" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="live_loads" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Structure designed to resist wind loads as required by code.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="wind_loads" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="wind_loads" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="wind_loads" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Seismic effects checked for new structures and critical retrofits for existing ones.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="seismic_checked" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="seismic_checked" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="seismic_checked" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Building dimensions verified on drawings and all sits.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dimensions_verified" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dimensions_verified" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dimensions_verified" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Visual inspection for cracks, settlement, or structural distress performed.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_inspection" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_inspection" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="visual_inspection" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Foundation type, depth, and condition verified for adequacy.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="foundation_verified" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="foundation_verified" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="foundation_verified" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Basic structural calculations performed for critical elements (columns, beams, slabs, footings).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structural_calculations" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structural_calculations" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="structural_calculations" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Roof design documented to include load-paths, redundancy, and safe load transfer to superstructure.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_design" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_design" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="roof_design" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Structural fire-resistance of load-bearing members (columns, beams, slabs) checked per applicable codes.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_resistance" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_resistance" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="fire_resistance" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Non-structural components (pipes, conduits, ducts) properly braced against seismic or wind loads.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="nonstructural_braced" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="nonstructural_braced" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="nonstructural_braced" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Floor load limits established and not exceeded; signage posted.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_load_limits" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_load_limits" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="floor_load_limits" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Heavy equipment foundations sized for weight & vibration control.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="equipment_foundations" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="equipment_foundations" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="equipment_foundations" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Anchoring of heavy components (battery racks, pumps, switchboards) designed to resist seismic and operational forces.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="anchoring" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="anchoring" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="anchoring" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Battery rooms, fire-pump rooms, and other emergency power supply areas are located at grade or below grade and are separated from other occupancies by fire-rated construction.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_fire_rooms" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_fire_rooms" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_fire_rooms" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Room door-hung in direction of egress and lead to a safe discharge point.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="door_hung" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="door_hung" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="door_hung" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Adequate light and working space provided for installation and future maintenance.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="light_working_space" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="light_working_space" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="light_working_space" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Wall, floor, and ceiling penetrations properly sealed to maintain required fire-resistance rating.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="penetrations_sealed" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="penetrations_sealed" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="penetrations_sealed" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Section 3: Electrical & Control Safety -->
            <div style="margin-bottom: 24px;">
              <div style="background: #eab308; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">‚ö° Electrical & Control Safety</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <thead>
                  <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                    <th style="padding: 8px; text-align: left; font-weight: 600; color: #475569; width: 60%;">Requirement</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">Yes</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">No</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">N/A</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">A single-line electrical diagram is provided showing the emergency power supply system, main utility connection, automatic transfer switch, bypass switch, alarm systems, emergency lighting and exit signage.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="single_line_diagram" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="single_line_diagram" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="single_line_diagram" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">The standby or backup power supply is sized to support all critical life-safety loads, including fire pumps, alarm systems, emergency lighting, and exit signage.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="backup_power_sized" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="backup_power_sized" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="backup_power_sized" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Automatic start-and-seamless change-over to backup power on loss of utility supply.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="automatic_start" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="automatic_start" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="automatic_start" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">ATS/UPS isolation provided without interrupting emergency loads.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ats_ups_isolation" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ats_ups_isolation" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="ats_ups_isolation" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Circuit breakers & protective relays coordinated for selective tripping and fire-safety loads.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="circuit_breakers" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="circuit_breakers" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="circuit_breakers" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">All electrical components listed / approved by recognized testing bodies (UL, FM, IEC3).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="electrical_components_listed" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="electrical_components_listed" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="electrical_components_listed" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Cables sized for normal and short-circuit duties with correct insulation rating.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="cables_sized" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="cables_sized" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="cables_sized" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Earthing / grounding of all metallic enclosures, trays, racks per NFPA 70 & local code.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="earthing_grounding" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="earthing_grounding" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="earthing_grounding" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Surge-protection devices are installed at the input and output of the backup power supply to protect sensitive fire-safety equipment.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="surge_protection" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="surge_protection" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="surge_protection" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Emergency lighting is powered from backup power with auto-battery per NFPA 101 & NFPA 70.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Supervisory alarms and the status of the backup power supply are integrated with the fire-alarm and/or building management system (BMS).</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="supervisory_alarms" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="supervisory_alarms" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="supervisory_alarms" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Section 4: Ventilation / Environmental & Battery Safety -->
            <div style="margin-bottom: 24px;">
              <div style="background: #10b981; color: white; padding: 8px 12px; border-radius: 4px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 600; font-size: 14px;">üå¨Ô∏è Ventilation / Environmental & Battery Safety</span>
              </div>
              
              <table style="width: 100%; border-collapse: collapse; font-size: 12px; margin-bottom: 12px;">
                <thead>
                  <tr style="background: #f8fafc; border-bottom: 2px solid #e2e8f0;">
                    <th style="padding: 8px; text-align: left; font-weight: 600; color: #475569; width: 60%;">Requirement</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">Yes</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">No</th>
                    <th style="padding: 8px; text-align: center; font-weight: 600; color: #475569; width: 13%;">N/A</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">A dedicated battery or backup-power room is provided with adequate space and is separated from other occupancies by fire-rated construction.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dedicated_battery_room" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dedicated_battery_room" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="dedicated_battery_room" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Battery-room ventilation sized to limit hydrogen concentration during charging to < 1 % of air volume.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_ventilation" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_ventilation" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_ventilation" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Room door, vents, louvers, away from air intakes or ignition sources.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="room_door_vents" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="room_door_vents" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="room_door_vents" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Battery-room temperature controlled within manufacturer's recommended range for safe operation.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_temperature" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_temperature" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_temperature" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Spill containment and acid neutralization facilities provided for liquid-cell batteries.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="spill_containment" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="spill_containment" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="spill_containment" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Battery racks constructed of non-combustible, acid-resistant materials.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_racks" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_racks" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="battery_racks" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Eye-wash station & spill kit installed in or near battery room.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="eyewash_station" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="eyewash_station" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="eyewash_station" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Smoke and heat detectors are installed in the battery or backup-power room and are connected to the building's fire-alarm system.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="smoke_heat_detectors" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="smoke_heat_detectors" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="smoke_heat_detectors" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Emergency lighting is installed in the battery or backup-power room.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting_battery_room" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting_battery_room" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="emergency_lighting_battery_room" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                  <tr style="border-bottom: 1px solid #e2e8f0;">
                    <td style="padding: 8px; color: #475569;">Clear access and working space maintained around batteries, rectifiers, ventilation ducts.</td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clear_access" value="Yes" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clear_access" value="No" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                    <td style="padding: 8px; text-align: center;">
                      <input type="radio" name="clear_access" value="N/A" style="width: 14px; height: 14px; margin: 0;">
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div style="margin-bottom: 20px;">
              <h4 style="margin: 0 0 10px 0; font-size: 14px; font-weight: 600; color: #64748b;">Additional Notes & Attachments</h4>
              <div class="form-group full-width" style="margin-bottom: 12px;">
                <label style="font-size: 13px; margin-bottom: 4px;">Comments</label>
                <textarea name="additional_notes" rows="3" style="font-size: 13px; padding: 6px;" placeholder="Additional observations"></textarea>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" class="action-button" style="background: #64748b; color: white;" onclick="goToDashboard()">Back</button>
              <button type="submit" class="action-button save-btn">üíæ Save</button>
              <button type="button" class="action-button reset-btn" onclick="resetForm('emergencyPowerFormData')">üîÑ Reset Form</button>
            </div>
          </form>
        </div>
      </div>
      </div>
    </div>

    </div> <!-- Close main-content -->
  </div> <!-- Close dashboard-container -->

  <script>
    // Sidebar toggle functionality
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.sidebar-overlay');
      
      sidebar.classList.toggle('open');
      overlay.classList.toggle('active');
    }

    // Tab switching functionality for main safety tabs
    // Simplified so every tab (including USC-Safe and Structural) reliably shows its content
    function switchTab(tabName) {
      // Default to overview if tabName is missing
      if (!tabName) tabName = 'overview';

      // Close sidebar after selecting
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.sidebar-overlay');
      if (sidebar) sidebar.classList.remove('open');
      if (overlay) overlay.classList.remove('active');

      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(c => {
        c.classList.remove('active');
        c.style.display = 'none';
      });

      // Clear active state from sidebar links
      document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));

      // Resolve the tab element by id (tab-<name>)
      let tabContent = document.getElementById('tab-' + tabName);
      if (!tabContent) {
        console.warn('Tab content not found for', tabName, 'falling back to overview');
        tabName = 'overview';
        tabContent = document.getElementById('tab-overview');
      }

      if (tabContent) {
        tabContent.style.display = 'block';
        tabContent.classList.add('active');
      }

      // Highlight matching sidebar nav item (Incidents, Grievances, USC‚ÄëSafe, etc.)
      document.querySelectorAll('.nav-link').forEach(link => {
        const onclick = link.getAttribute('onclick') || '';
        if (onclick.includes("'" + tabName + "'")) {
          link.classList.add('active');
        }
      });

      // Fire per-tab loaders where they exist
      try {
        if (tabName === 'incidents' && typeof loadIncidents === 'function') {
          loadIncidents();
        } else if (tabName === 'grievances' && typeof loadGrievances === 'function') {
          loadGrievances();
        } else if (tabName === 'fire' && typeof loadFireSafetyData === 'function') {
          loadFireSafetyData();
        } else if (tabName === 'electrical' && typeof loadElectrical === 'function') {
          loadElectrical();
        } else if (tabName === 'structural' && typeof loadStructural === 'function') {
          loadStructural();
        } else if (tabName === 'health' && typeof loadHealth === 'function') {
          loadHealth();
        }
      } catch (e) {
        console.warn('Tab loader failed for', tabName, e);
      }
    }

    // Wire up click handlers only for the main horizontal safety tabs
    document.querySelectorAll('#tabs-navigation .tab-item').forEach(tab => {
      tab.addEventListener('click', function () {
        const tabName = this.getAttribute('data-tab');
        if (tabName) {
          switchTab(tabName);
        }
      });
    });

    // Existing scripts
    // Add click interactivity
    document.querySelectorAll('.status-item').forEach(item => {
      item.addEventListener('click', function() {
        const label = this.querySelector('.status-label').textContent.trim();
        alert(`Viewing: ${label}`);
      });
    });

    document.querySelectorAll('.incident-item').forEach(item => {
      item.addEventListener('click', function(e) {
        if (!e.target.classList.contains('view-link')) {
          const title = this.querySelector('.incident-title').textContent;
          alert(`Opening incident: ${title}`);
        }
      });
    });

    // Action buttons now use onclick attribute, no need for event listeners


    // ==================== EMBEDDED MODULE HELPERS (HR / ACCOUNTS / AUDIT / AGENT) ====================
    function loadInWorkingPane(url){
      const pane = document.querySelector('.working-pane');
      if(!pane) return;
      pane.innerHTML = `<iframe src="${url}" style="width:100%;height:100%;border:0;min-height:600px"></iframe>`;
    }

    function showAccountingTabs(initial){
      const pane = document.querySelector('.working-pane');
      if(!pane) return;
      const embeddedSuffix = '?embedded=1';
      const html = `
        <div class="top-compact-tabs">
          <button class="ct" onclick="loadInWorkingPane('/accounting/dashboard.html' + embeddedSuffix)">Dashboard</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/receivables.html' + embeddedSuffix)">Receivable</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/payables.html' + embeddedSuffix)">Payable</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/received-paid.html?tab=received&embedded=1')">Received</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/received-paid.html?tab=paid&embedded=1')">Paid</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/banks.html' + embeddedSuffix)">Banks</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/transfer.html' + embeddedSuffix)">Transfer</button>
          <button class="ct" onclick="loadInWorkingPane('/accounting/petty-cash.html' + embeddedSuffix)">Petty Cash</button>
        </div>
        <div style="margin-top:8px;height:calc(100% - 40px);min-height:580px">
          <iframe id="accountingFrame" src="" style="width:100%;height:100%;border:0;"></iframe>
        </div>`;
      pane.innerHTML = html;
      const startUrl = initial==='dashboard'
        ? '/accounting/dashboard.html' + embeddedSuffix
        : initial==='receivables'
          ? '/accounting/receivables.html' + embeddedSuffix
          : initial==='payables'
            ? '/accounting/payables.html' + embeddedSuffix
            : '/accounting/dashboard.html' + embeddedSuffix;
      const frame = pane.querySelector('#accountingFrame');
      if(frame) frame.src = startUrl;
    }

    // ==================== FORM MANAGEMENT ====================
    
    // Navigate to Dashboard (Overview tab)
    function goToDashboard() {
      switchTab('overview');
    }

    // Reset Form
    function resetForm(formId) {
      const form = document.getElementById(formId);
      form.reset();
      // Reset radio buttons to default (first option or none)
      form.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.checked = false;
      });
    }

    // ==================== INCIDENTS ====================
    
    async function saveIncident(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/incidents', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Incident saved successfully!');
          resetForm('incidentFormData');
          loadIncidents();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving incident:', error);
        alert('‚ùå Failed to save incident');
      }
    }

    async function loadIncidents() {
      try {
        const response = await fetch('/api/safety/incidents');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('incident-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No incidents found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(incident => `
            <tr>
              <td>${incident.Id}</td>
              <td>${new Date(incident.IncidentDate).toLocaleString()}</td>
              <td>${incident.IncidentType}</td>
              <td>${incident.Location}</td>
              <td>${incident.Severity || 'N/A'}</td>
              <td><span class="status-badge status-${incident.Status.toLowerCase().replace(' ', '-')}">${incident.Status}</span></td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editIncident(${incident.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteIncident(${incident.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading incidents:', error);
      }
    }

    async function deleteIncident(id) {
      if (!confirm('Are you sure you want to delete this incident?')) return;
      
      try {
        const response = await fetch(`/api/safety/incidents/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Incident deleted successfully!');
          loadIncidents();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting incident:', error);
        alert('‚ùå Failed to delete incident');
      }
    }

    // ==================== GRIEVANCES ====================
    
    async function saveGrievance(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/grievances', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Grievance saved successfully!');
          resetForm('grievanceFormData');
          loadGrievances();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving grievance:', error);
        alert('‚ùå Failed to save grievance');
      }
    }

    async function loadGrievances() {
      try {
        const response = await fetch('/api/safety/grievances');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('grievance-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No grievances found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(grievance => `
            <tr>
              <td>${grievance.Id}</td>
              <td>${new Date(grievance.GrievanceDate).toLocaleString()}</td>
              <td>${grievance.GrievanceType}</td>
              <td>${grievance.ComplainantName || 'Anonymous'}</td>
              <td>${grievance.Priority || 'N/A'}</td>
              <td><span class="status-badge status-${grievance.Status.toLowerCase().replace(' ', '-')}">${grievance.Status}</span></td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editGrievance(${grievance.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteGrievance(${grievance.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading grievances:', error);
      }
    }

    async function deleteGrievance(id) {
      if (!confirm('Are you sure you want to delete this grievance?')) return;
      
      try {
        const response = await fetch(`/api/safety/grievances/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Grievance deleted successfully!');
          loadGrievances();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting grievance:', error);
        alert('‚ùå Failed to delete grievance');
      }
    }

    // ==================== FIRE SAFETY ====================
    
    async function saveFireSafety(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      console.log('üîÑ Saving fire safety data:', data);

      try {
        const response = await fetch('/api/safety/fire', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ formData: data }),  // Wrap in formData object
          credentials: 'same-origin'
        });
        
        const result = await response.json();
        console.log('üì• Server response:', result);
        
        if (result.success) {
          alert('‚úÖ Fire safety data saved successfully!');
          // Don't reset form - keep values visible
          // resetForm('fireFormData');
          loadFireSafety();
        } else {
          alert('‚ùå Error: ' + result.error);
          console.error('Server error:', result.error);
        }
      } catch (error) {
        console.error('‚ùå Error saving fire safety record:', error);
        alert('‚ùå Failed to save fire safety record: ' + error.message);
      }
    }

    async function loadFireSafety() {
      try {
        const response = await fetch('/api/safety/fire');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('fire-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No fire safety records found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(record => `
            <tr>
              <td>${record.Id}</td>
              <td>${new Date(record.InspectionDate).toLocaleString()}</td>
              <td>${record.Location}</td>
              <td>${record.EquipmentType || 'N/A'}</td>
              <td><span class="status-badge status-${record.Status.toLowerCase().replace(' ', '-')}">${record.Status}</span></td>
              <td>${record.InspectedBy || 'N/A'}</td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editFireSafety(${record.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteFireSafety(${record.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading fire safety records:', error);
      }
    }

    async function deleteFireSafety(id) {
      if (!confirm('Are you sure you want to delete this fire safety record?')) return;
      
      try {
        const response = await fetch(`/api/safety/fire/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Fire safety record deleted successfully!');
          loadFireSafety();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting fire safety record:', error);
        alert('‚ùå Failed to delete fire safety record');
      }
    }

    // ==================== EXCEL EXPORT ====================
    
    function exportToExcel(type) {
      let tableId, filename;
      
      switch(type) {
        case 'incidents':
          tableId = 'incident-table-body';
          filename = 'Safety_Incidents_Export.csv';
          break;
        case 'grievances':
          tableId = 'grievance-table-body';
          filename = 'Safety_Grievances_Export.csv';
          break;
        case 'fire':
          tableId = 'fire-table-body';
          filename = 'Fire_Safety_Export.csv';
          break;
        default:
          alert('Invalid export type');
          return;
      }

      const table = document.getElementById(tableId).closest('table');
      const rows = Array.from(table.querySelectorAll('tr'));
      
      let csv = [];
      rows.forEach(row => {
        const cols = Array.from(row.querySelectorAll('th, td'));
        const rowData = cols.map(col => {
          let text = col.textContent.trim();
          // Remove action buttons from export
          if (col.querySelector('.table-action-btn')) {
            return '';
          }
          return `"${text.replace(/"/g, '""')}"`;
        }).filter(cell => cell !== '');
        csv.push(rowData.join(','));
      });

      // Create and download CSV
      const csvContent = csv.join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', filename);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Data exported to CSV successfully!');
    }

    // ==================== ELECTRICAL SAFETY ====================
    
    async function saveElectrical(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/electrical', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Electrical safety record saved successfully!');
          resetForm('electricalFormData');
          loadElectrical();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving electrical record:', error);
        alert('‚ùå Failed to save electrical safety record');
      }
    }

    async function loadElectrical() {
      try {
        const response = await fetch('/api/safety/electrical');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('electrical-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No electrical safety records found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(record => `
            <tr>
              <td>${record.Id}</td>
              <td>${new Date(record.InspectionDate).toLocaleString()}</td>
              <td>${record.Location}</td>
              <td>${record.EquipmentType || 'N/A'}</td>
              <td>${record.Voltage || 'N/A'}</td>
              <td><span class="status-badge status-${record.Status.toLowerCase().replace(' ', '-')}">${record.Status}</span></td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editElectrical(${record.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteElectrical(${record.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading electrical records:', error);
      }
    }

    async function deleteElectrical(id) {
      if (!confirm('Are you sure you want to delete this electrical safety record?')) return;
      
      try {
        const response = await fetch(`/api/safety/electrical/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Electrical safety record deleted successfully!');
          loadElectrical();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting electrical record:', error);
        alert('‚ùå Failed to delete electrical safety record');
      }
    }

    // ==================== STRUCTURAL SAFETY ====================
    
    async function saveStructural(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/structural', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Structural safety record saved successfully!');
          resetForm('structuralFormData');
          loadStructural();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving structural record:', error);
        alert('‚ùå Failed to save structural safety record');
      }
    }

    async function loadStructural() {
      try {
        const response = await fetch('/api/safety/structural');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('structural-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No structural safety records found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(record => `
            <tr>
              <td>${record.Id}</td>
              <td>${new Date(record.InspectionDate).toLocaleString()}</td>
              <td>${record.Location}</td>
              <td>${record.StructureType || 'N/A'}</td>
              <td><span class="status-badge status-${record.Status.toLowerCase().replace(' ', '-')}">${record.Status}</span></td>
              <td>${record.InspectedBy || 'N/A'}</td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editStructural(${record.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteStructural(${record.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading structural records:', error);
      }
    }

    async function deleteStructural(id) {
      if (!confirm('Are you sure you want to delete this structural safety record?')) return;
      
      try {
        const response = await fetch(`/api/safety/structural/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Structural safety record deleted successfully!');
          loadStructural();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting structural record:', error);
        alert('‚ùå Failed to delete structural safety record');
      }
    }

    // ==================== HEALTH HAZARDS ====================
    
    async function saveHealth(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/health', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Health hazard record saved successfully!');
          resetForm('healthFormData');
          loadHealth();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving health hazard record:', error);
        alert('‚ùå Failed to save health hazard record');
      }
    }

    async function loadHealth() {
      try {
        const response = await fetch('/api/safety/health');
        const result = await response.json();
        
        if (result.success) {
          const tbody = document.getElementById('health-table-body');
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7" style="text-align:center; padding:20px;">No health hazard records found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(record => `
            <tr>
              <td>${record.Id}</td>
              <td>${new Date(record.AssessmentDate).toLocaleString()}</td>
              <td>${record.Location}</td>
              <td>${record.HazardType || 'N/A'}</td>
              <td>${record.RiskLevel || 'N/A'}</td>
              <td><span class="status-badge status-${record.Status.toLowerCase().replace(' ', '-')}">${record.Status}</span></td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editHealth(${record.Id})">‚úèÔ∏è Edit</button>
                <button class="table-action-btn btn-delete" onclick="deleteHealth(${record.Id})">üóëÔ∏è Delete</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (error) {
        console.error('Error loading health hazard records:', error);
      }
    }

    async function deleteHealth(id) {
      if (!confirm('Are you sure you want to delete this health hazard record?')) return;
      
      try {
        const response = await fetch(`/api/safety/health/${id}`, { method: 'DELETE' });
        const result = await response.json();
        
        if (result.success) {
          alert('‚úÖ Health hazard record deleted successfully!');
          loadHealth();
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error deleting health hazard record:', error);
        alert('‚ùå Failed to delete health hazard record');
      }
    }

    // ==================== USC-SAFE ====================
    
    async function saveUSCSafe(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/usc-safe', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ USC-Safe checklist saved successfully!');
          resetForm('uscSafeFormData');
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving USC-Safe checklist:', error);
        alert('‚ùå Failed to save USC-Safe checklist');
      }
    }

    // ==================== GAS SAFETY ====================
    
    async function saveGas(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveGasSafety) {
          await SafetyAPI.saveGasSafety(data);
          SafetyAPI.showSuccessMessage('Gas safety checklist saved successfully!');
        } else {
          const response = await fetch('/api/safety/gas', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          const result = await response.json();
          if (!result.success) {
            throw new Error(result.error || 'Failed to save gas safety checklist');
          }
          alert('‚úÖ Gas safety checklist saved successfully!');
        }

        form.reset();
        if (typeof setDefaultRadioButtons === 'function') {
          setDefaultRadioButtons(form.id);
        }
      } catch (error) {
        console.error('Error saving gas safety checklist:', error);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(error.message || 'Failed to save gas safety checklist');
        } else {
          alert('‚ùå Failed to save gas safety checklist');
        }
      }
    }

    // ==================== BOILER SAFETY ====================
    
    async function saveBoiler(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveBoilerSafety) {
          await SafetyAPI.saveBoilerSafety(data);
          SafetyAPI.showSuccessMessage('Boiler safety data saved successfully!');
        } else {
          const response = await fetch('/api/safety/boiler', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          const result = await response.json();
          if (!result.success) {
            throw new Error(result.error || 'Failed to save boiler safety data');
          }
          alert('‚úÖ Boiler safety data saved successfully!');
        }

        form.reset();
        if (typeof setDefaultRadioButtons === 'function') {
          setDefaultRadioButtons(form.id);
        }
      } catch (error) {
        console.error('Error saving boiler safety data:', error);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(error.message || 'Failed to save boiler safety data');
        } else {
          alert('‚ùå Failed to save boiler safety data');
        }
      }
    }

    // ==================== CONSULTANT ENGAGEMENT ====================
    
    async function saveConsultant(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/consultant', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Consultant engagement checklist saved successfully!');
          resetForm('consultantFormData');
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving consultant engagement checklist:', error);
        alert('‚ùå Failed to save consultant engagement checklist');
      }
    }

    // ==================== DSA ====================
    
    async function saveDSA(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/dsa', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ DSA checklist saved successfully!');
          resetForm('dsaFormData');
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving DSA checklist:', error);
        alert('‚ùå Failed to save DSA checklist');
      }
    }

    // ==================== EMERGENCY POWER ====================
    
    async function saveEmergencyPower(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      try {
        const response = await fetch('/api/safety/emergency-power', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Emergency Power checklist saved successfully!');
          resetForm('emergencyPowerFormData');
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (error) {
        console.error('Error saving emergency power checklist:', error);
        alert('‚ùå Failed to save emergency power checklist');
      }
    }

    // Update export function to handle all tabs
    const originalExport = exportToExcel;
    exportToExcel = function(type) {
      let tableId, filename;
      
      switch(type) {
        case 'incidents':
          tableId = 'incident-table-body';
          filename = 'Safety_Incidents_Export.csv';
          break;
        case 'grievances':
          tableId = 'grievance-table-body';
          filename = 'Safety_Grievances_Export.csv';
          break;
        case 'fire':
          tableId = 'fire-table-body';
          filename = 'Fire_Safety_Export.csv';
          break;
        case 'electrical':
          tableId = 'electrical-table-body';
          filename = 'Electrical_Safety_Export.csv';
          break;
        case 'structural':
          tableId = 'structural-table-body';
          filename = 'Structural_Safety_Export.csv';
          break;
        case 'health':
          tableId = 'health-table-body';
          filename = 'Health_Hazards_Export.csv';
          break;
        case 'gas':
          // Gas tab uses form data export
          exportGasForm();
          return;
        case 'boiler':
          // Boiler tab uses form data export
          exportBoilerForm();
          return;
        case 'consultant':
          // Consultant tab uses form data export
          exportConsultantForm();
          return;
        case 'dsa':
          // DSA tab uses form data export
          exportDSAForm();
          return;
        case 'emergency-power':
          // Emergency Power tab uses form data export
          exportEmergencyPowerForm();
          return;
        case 'usc-safe':
          // USC-Safe tab uses form data export
          exportUSCSafeForm();
          return;
        default:
          alert('Invalid export type');
          return;
      }

      const table = document.getElementById(tableId).closest('table');
      const rows = Array.from(table.querySelectorAll('tr'));
      
      let csv = [];
      rows.forEach(row => {
        const cols = Array.from(row.querySelectorAll('th, td'));
        const rowData = cols.map(col => {
          let text = col.textContent.trim();
          if (col.querySelector('.table-action-btn')) return '';
          return `"${text.replace(/"/g, '""')}"`;
        }).filter(cell => cell !== '');
        csv.push(rowData.join(','));
      });

      const csvContent = csv.join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', filename);
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Data exported to CSV successfully!');
    };

    // Export form data functions
    function exportGasForm() {
      const form = document.getElementById('gasFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'Gas_Safety_Checklist_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Gas safety checklist exported to CSV successfully!');
    }

    function exportUSCSafeForm() {
      const form = document.getElementById('uscSafeFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'USC_Safe_Checklist_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ USC-Safe checklist exported to CSV successfully!');
    }

    function exportBoilerForm() {
      const form = document.getElementById('boilerFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'Boiler_Safety_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Boiler safety data exported to CSV successfully!');
    }

    function exportConsultantForm() {
      const form = document.getElementById('consultantFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'Consultant_Engagement_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Consultant engagement checklist exported to CSV successfully!');
    }

    function exportDSAForm() {
      const form = document.getElementById('dsaFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'DSA_Checklist_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ DSA checklist exported to CSV successfully!');
    }

    function exportEmergencyPowerForm() {
      const form = document.getElementById('emergencyPowerFormData');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      // Convert to CSV
      let csv = 'Field,Value\\n';
      for (const [key, value] of Object.entries(data)) {
        csv += `"${key}","${value}"\\n`;
      }
      
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', 'Emergency_Power_Checklist_Export.csv');
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('‚úÖ Emergency Power checklist exported to CSV successfully!');
    }

    // Placeholder edit functions (to be implemented)
    function editIncident(id) {
      alert('Edit functionality for incident ' + id + ' - To be implemented');
    }

    function editGrievance(id) {
      alert('Edit functionality for grievance ' + id + ' - To be implemented');
    }

    function editFireSafety(id) {
      alert('Edit functionality for fire safety record ' + id + ' - To be implemented');
    }

    function editElectrical(id) {
      alert('Edit functionality for electrical safety record ' + id + ' - To be implemented');
    }

    function editStructural(id) {
      alert('Edit functionality for structural safety record ' + id + ' - To be implemented');
    }

    function editHealth(id) {
      alert('Edit functionality for health hazard record ' + id + ' - To be implemented');
    }

    // ==================== SAVE FUNCTIONS (DB-backed via SafetyAPI) ====================
    
    async function saveUSCSafe(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveUSCSafe) {
          await SafetyAPI.saveUSCSafe(data);
          SafetyAPI.showSuccessMessage('USC-Safe checklist saved successfully!');
        } else {
          await fetch('/api/safety/usc-safe', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ USC-Safe checklist saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving USC-Safe:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save USC-Safe checklist');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveElectrical(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveElectricalSafety) {
          await SafetyAPI.saveElectricalSafety(data);
          SafetyAPI.showSuccessMessage('Electrical safety data saved successfully!');
        } else {
          await fetch('/api/safety/electrical', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Electrical safety data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
        if (typeof loadElectrical === 'function') {
          loadElectrical();
        }
      } catch (err) {
        console.error('Error saving electrical:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save electrical safety data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveStructural(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveStructuralSafety) {
          await SafetyAPI.saveStructuralSafety(data);
          SafetyAPI.showSuccessMessage('Structural safety data saved successfully!');
        } else {
          await fetch('/api/safety/structural', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Structural safety data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
        if (typeof loadStructural === 'function') {
          loadStructural();
        }
      } catch (err) {
        console.error('Error saving structural:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save structural safety data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveHealth(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveHealthHazards) {
          await SafetyAPI.saveHealthHazards(data);
          SafetyAPI.showSuccessMessage('Health hazards data saved successfully!');
        } else {
          await fetch('/api/safety/health', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Health hazards data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
        if (typeof loadHealth === 'function') {
          loadHealth();
        }
      } catch (err) {
        console.error('Error saving health hazards:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save health hazards data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveGasSafety(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveGasSafety) {
          await SafetyAPI.saveGasSafety(data);
          SafetyAPI.showSuccessMessage('Gas safety data saved successfully!');
        } else {
          await fetch('/api/safety/gas', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Gas safety data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving gas safety:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save gas safety data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveBoilerSafety(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveBoilerSafety) {
          await SafetyAPI.saveBoilerSafety(data);
          SafetyAPI.showSuccessMessage('Boiler safety data saved successfully!');
        } else {
          await fetch('/api/safety/boiler', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Boiler safety data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving boiler safety:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save boiler safety data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveConsultant(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveConsultant) {
          await SafetyAPI.saveConsultant(data);
          SafetyAPI.showSuccessMessage('Consultant engagement data saved successfully!');
        } else {
          await fetch('/api/safety/consultant', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Consultant engagement data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving consultant:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save consultant engagement data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveDSA(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveDSA) {
          await SafetyAPI.saveDSA(data);
          SafetyAPI.showSuccessMessage('DSA data saved successfully!');
        } else {
          await fetch('/api/safety/dsa', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ DSA data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving DSA:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save DSA data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveEmergencyPower(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveEmergencyPower) {
          await SafetyAPI.saveEmergencyPower(data);
          SafetyAPI.showSuccessMessage('Emergency power data saved successfully!');
        } else {
          await fetch('/api/safety/emergency-power', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Emergency power data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving emergency power:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save emergency power data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveSafetyTraining(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveSafetyTraining) {
          await SafetyAPI.saveSafetyTraining(data);
          SafetyAPI.showSuccessMessage('Safety training data saved successfully!');
        } else {
          await fetch('/api/safety/training', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ Safety training data saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving safety training:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save safety training data');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    async function saveUNGPChecklist(event) {
      event.preventDefault();
      const form = event.target;
      try {
        const data = (window.SafetyAPI && SafetyAPI.collectFormData)
          ? SafetyAPI.collectFormData(form)
          : Object.fromEntries(new FormData(form).entries());

        if (window.SafetyAPI && SafetyAPI.saveUNGP) {
          await SafetyAPI.saveUNGP(data);
          SafetyAPI.showSuccessMessage('UNGP checklist saved successfully!');
        } else {
          await fetch('/api/safety/ungp', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ formData: data })
          });
          alert('‚úÖ UNGP checklist saved successfully!');
        }

        form.reset();
        setDefaultRadioButtons(form.id);
      } catch (err) {
        console.error('Error saving UNGP:', err);
        if (window.SafetyAPI && SafetyAPI.showErrorMessage) {
          SafetyAPI.showErrorMessage(err.message || 'Failed to save UNGP checklist');
        } else {
          alert('‚ùå Error saving data: ' + err.message);
        }
      }
    }

    // Helper function to reset forms
    function resetForm(formId) {
      const form = document.getElementById(formId);
      if (form) {
        form.reset();
        // Set N/A as default for all radio buttons after reset
        setDefaultRadioButtons(formId);
        alert('üîÑ Form reset successfully!');
      }
    }

    // ==================== INCIDENT & GRIEVANCE FUNCTIONS ====================
    
    // Dynamic sections for Incident form
    function addInjuredPerson() {
      const container = document.getElementById('injuredPersonsContainer');
      if (!container) return;
      const index = container.children.length + 1;
      const wrapper = document.createElement('div');
      wrapper.className = 'injured-person-card';
      wrapper.style.marginBottom = '12px';
      wrapper.style.padding = '12px';
      wrapper.style.border = '1px solid #e2e8f0';
      wrapper.style.borderRadius = '8px';
      wrapper.innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
          <strong>Injured Person ${index}</strong>
          <button type="button" class="table-action-btn btn-delete" onclick="this.closest('.injured-person-card').remove()">Remove</button>
        </div>
        <div style="display:grid; grid-template-columns: repeat(3,1fr); gap:12px;">
          <div>
            <label style="font-size:12px;">Name</label>
            <input type="text" name="injuredPersonName${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
          <div>
            <label style="font-size:12px;">Job Title</label>
            <input type="text" name="injuredPersonJobTitle${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
          <div>
            <label style="font-size:12px;">Injury Description</label>
            <input type="text" name="injuryDescription${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
        </div>
      `;
      container.appendChild(wrapper);
    }

    function addDamagedEquipment() {
      const container = document.getElementById('damagedEquipmentContainer');
      if (!container) return;
      const index = container.children.length + 1;
      const wrapper = document.createElement('div');
      wrapper.className = 'damaged-equipment-card';
      wrapper.style.marginBottom = '12px';
      wrapper.style.padding = '12px';
      wrapper.style.border = '1px solid #e2e8f0';
      wrapper.style.borderRadius = '8px';
      wrapper.innerHTML = `
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
          <strong>Damaged Equipment ${index}</strong>
          <button type="button" class="table-action-btn btn-delete" onclick="this.closest('.damaged-equipment-card').remove()">Remove</button>
        </div>
        <div style="display:grid; grid-template-columns: repeat(3,1fr); gap:12px;">
          <div>
            <label style="font-size:12px;">Machine/Asset</label>
            <input type="text" name="damagedEquipmentName${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
          <div>
            <label style="font-size:12px;">Damage Description</label>
            <input type="text" name="damageDescription${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
          <div>
            <label style="font-size:12px;">Estimated Cost</label>
            <input type="number" name="damageCost${index}" style="width:100%; font-size:13px; padding:6px; border:1px solid #e2e8f0; border-radius:6px;">
          </div>
        </div>
      `;
      container.appendChild(wrapper);
    }
    
    async function saveIncident(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const rawData = Object.fromEntries(formData.entries());
      
      // Normalize date for API/SQL
      let incidentDate = rawData.incidentDateTime || rawData.incidentDate;
      if (incidentDate) {
        try {
          incidentDate = new Date(incidentDate).toISOString();
        } catch {
          // Fallback to raw string if parsing fails
        }
      }
      
      // Map form fields to API fields
      const data = {
        incidentDate,
        incidentType: rawData.incidentType,
        location: rawData.location,
        department: rawData.department,
        description: rawData.description,
        reportedBy: rawData.reporterName || rawData.reportedBy,
        status: 'Open'
      };
      
      console.log('Saving incident:', data);
      
      try {
        const response = await fetch('/api/safety/incidents', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
          credentials: 'same-origin'
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Incident saved successfully!');
          form.reset();
          loadIncidents(); // Reload the table
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (err) {
        console.error('Error saving incident:', err);
        alert('‚ùå Error saving incident: ' + err.message);
      }
    }

    async function saveGrievance(event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);
      const rawData = Object.fromEntries(formData.entries());
      
      // Map form fields to API fields
      const data = {
        grievanceDate: rawData.dateOfComplaint || rawData.grievanceDate,
        complainantName: rawData.employeeName || rawData.complainantName,
        complainantRole: rawData.jobTitle || rawData.complainantRole,
        grievanceType: 'General',
        category: rawData.department || 'General',
        description: JSON.stringify(rawData), // Store full form payload
        status: 'Pending'
      };
      
      console.log('Saving grievance:', data);
      
      try {
        const response = await fetch('/api/safety/grievances', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
          credentials: 'same-origin'
        });
        
        const result = await response.json();
        if (result.success) {
          alert('‚úÖ Grievance saved successfully!');
          form.reset();
          loadGrievances(); // Reload the tables
        } else {
          alert('‚ùå Error: ' + result.error);
        }
      } catch (err) {
        console.error('Error saving grievance:', err);
        alert('‚ùå Error saving grievance: ' + err.message);
      }
    }

    // ==================== LOAD & SEARCH FUNCTIONS ====================
    
    async function loadIncidents() {
      try {
        const response = await fetch('/api/safety/incidents', { credentials: 'same-origin' });
        const result = await response.json();
        
        if (result.success && result.data) {
          const tbody = document.getElementById('incident-table-body');
          if (!tbody) return;
          
          if (result.data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="8" style="text-align:center; padding:20px;">No incidents found</td></tr>';
            return;
          }
          
          tbody.innerHTML = result.data.map(incident => `
            <tr>
              <td>${incident.Id}</td>
              <td>${incident.IncidentDate ? new Date(incident.IncidentDate).toLocaleDateString() : '-'}</td>
              <td>${incident.IncidentType || '-'}</td>
              <td>${incident.Location || '-'}</td>
              <td>${incident.Department || '-'}</td>
              <td>${incident.ReportedBy || '-'}</td>
              <td><span class="status-badge status-${incident.Status?.toLowerCase()}">${incident.Status || 'Open'}</span></td>
              <td>
                <button class="table-action-btn btn-edit" onclick="editIncident(${incident.Id})">Edit</button>
              </td>
            </tr>
          `).join('');
        }
      } catch (err) {
        console.error('Error loading incidents:', err);
      }
    }

    async function loadGrievances() {
      try {
        const response = await fetch('/api/safety/grievances', { credentials: 'same-origin' });
        const result = await response.json();
        
        if (result.success && result.data) {
          console.log('Grievances loaded:', result.data);
        }
      } catch (err) {
        console.error('Error loading grievances:', err);
      }
    }

    // Populate and filter Search Incident tab
    async function populateSearchIncidents() {
      try {
        const response = await fetch('/api/safety/incidents', { credentials: 'same-origin' });
        const result = await response.json();
        if (!result.success || !result.data) return;
        const tbody = document.getElementById('search-incident-table-body');
        if (!tbody) return;
        if (result.data.length === 0) {
          tbody.innerHTML = '<tr><td colspan="8" style="text-align:center; padding:20px;">No incidents found</td></tr>';
          return;
        }
        tbody.innerHTML = result.data.map(incident => `
          <tr data-incident-row>
            <td>${incident.IncidentDate ? new Date(incident.IncidentDate).toLocaleDateString() : '-'}</td>
            <td>${incident.ReportedBy || '-'}</td>
            <td>${incident.ReporterJobTitle || '-'}</td>
            <td>${incident.IncidentType || '-'}</td>
            <td>${incident.Location || '-'}</td>
            <td>${incident.Department || '-'}</td>
            <td>${incident.Status || 'Open'}</td>
            <td style="text-align:center;">
              <button onclick="viewIncident(${incident.Id})" class="table-action-btn btn-view">View</button>
            </td>
          </tr>
        `).join('');
      } catch (err) {
        console.error('Error populating search incidents:', err);
      }
    }

    function filterIncidents() {
      const input = document.getElementById('searchIncidentInput');
      if (!input) return;
      const query = input.value.toLowerCase();
      const rows = document.querySelectorAll('#search-incident-table-body tr[data-incident-row]');
      rows.forEach(row => {
        row.style.display = row.textContent.toLowerCase().includes(query) ? '' : 'none';
      });
    }

    async function searchIncidents() {
      await populateSearchIncidents();
      filterIncidents();
    }

    async function viewIncident(id) {
      try {
        const response = await fetch(`/api/safety/incidents/${id}`, { credentials: 'same-origin' });
        const result = await response.json();
        if (!result.success || !result.data) {
          alert('Unable to load incident details.');
          return;
        }
        const incident = result.data;
        alert(`Incident #${incident.Id}\nType: ${incident.IncidentType || '-'}\nLocation: ${incident.Location || '-'}\nDepartment: ${incident.Department || '-'}\nDescription: ${incident.Description || ''}`);
      } catch (err) {
        console.error('Error viewing incident:', err);
        alert('Error loading incident details.');
      }
    }

    // Populate and filter Search Grievance tab
    async function populateSearchGrievances() {
      try {
        const response = await fetch('/api/safety/grievances', { credentials: 'same-origin' });
        const result = await response.json();
        if (!result.success || !result.data) return;
        const tbody = document.getElementById('search-grievance-table-body');
        if (!tbody) return;
        if (result.data.length === 0) {
          tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; padding:20px;">No grievances found</td></tr>';
          return;
        }
        tbody.innerHTML = result.data.map(g => `
          <tr data-grievance-row>
            <td>${g.GrievanceDate ? new Date(g.GrievanceDate).toLocaleDateString() : '-'}</td>
            <td>${g.ComplainantName || '-'}</td>
            <td>${g.Department || '-'}</td>
            <td>${g.GrievanceType || '-'}</td>
            <td>${g.Status || 'Pending'}</td>
            <td style="text-align:center;">
              <button onclick="viewGrievance(${g.Id})" class="table-action-btn btn-view">View</button>
            </td>
          </tr>
        `).join('');
      } catch (err) {
        console.error('Error populating search grievances:', err);
      }
    }

    function filterGrievances() {
      const input = document.getElementById('searchGrievanceInput');
      if (!input) return;
      const query = input.value.toLowerCase();
      const rows = document.querySelectorAll('#search-grievance-table-body tr[data-grievance-row]');
      rows.forEach(row => {
        row.style.display = row.textContent.toLowerCase().includes(query) ? '' : 'none';
      });
    }

    async function searchGrievances() {
      await populateSearchGrievances();
      filterGrievances();
    }

    async function viewGrievance(id) {
      try {
        const response = await fetch(`/api/safety/grievances/${id}`, { credentials: 'same-origin' });
        const result = await response.json();
        if (!result.success || !result.data) {
          alert('Unable to load grievance details.');
          return;
        }
        const g = result.data;
        alert(`Grievance #${g.Id}\nName: ${g.ComplainantName || '-'}\nType: ${g.GrievanceType || '-'}\nStatus: ${g.Status || 'Pending'}\nDescription: ${g.Description || ''}`);
      } catch (err) {
        console.error('Error viewing grievance:', err);
        alert('Error loading grievance details.');
      }
    }

    // Set N/A as default for all radio buttons in a form
    function setDefaultRadioButtons(formId) {
      const form = document.getElementById(formId);
      if (!form) return;
      
      // Get all unique radio button names
      const radioNames = new Set();
      form.querySelectorAll('input[type="radio"]').forEach(radio => {
        if (radio.name) radioNames.add(radio.name);
      });
      
      // For each radio group, if no button is checked, check the last one (usually N/A)
      radioNames.forEach(name => {
        const radios = form.querySelectorAll(`input[type="radio"][name="${name}"]`);
        const checkedRadio = Array.from(radios).find(r => r.checked);
        
        if (!checkedRadio && radios.length > 0) {
          // Check the last radio button (usually N/A)
          radios[radios.length - 1].checked = true;
        }
      });
    }

    // Generic helper to load the latest saved JSON form data via SafetyAPI
    async function loadFormFromSafetyAPI(loaderFn, formId) {
      try {
        if (!loaderFn || !window.SafetyAPI || !SafetyAPI.populateForm) return;
        const raw = await loaderFn();
        if (!raw) return;
        const data = Array.isArray(raw) ? null : raw;
        if (!data) return;
        const form = document.getElementById(formId);
        if (form) {
          SafetyAPI.populateForm(form, data);
        }
      } catch (err) {
        console.error(`Error loading data for form ${formId}:`, err);
      }
    }

    // Load fire safety data
    async function loadFireSafetyData() {
      // First set N/A as default for all radio buttons
      setDefaultRadioButtons('fireFormData');
      
      try {
        const response = await fetch('/api/safety/fire', { credentials: 'same-origin' });
        const result = await response.json();
        
        if (result.success && result.data && result.data.length > 0) {
          // Get the most recent record
          const latestRecord = result.data[0];
          if (latestRecord.FormData) {
            const formData = JSON.parse(latestRecord.FormData);
            const form = document.getElementById('fireFormData');
            if (form) {
              // Populate form fields
              Object.keys(formData).forEach(key => {
                const input = form.querySelector(`[name="${key}"]`);
                if (input) {
                  if (input.type === 'radio') {
                    const radio = form.querySelector(`[name="${key}"][value="${formData[key]}"]`);
                    if (radio) radio.checked = true;
                  } else if (input.type === 'checkbox') {
                    input.checked = formData[key] === 'on' || formData[key] === true;
                  } else {
                    input.value = formData[key];
                  }
                }
              });
              console.log('Fire safety data loaded successfully');
            }
          }
        }
      } catch (err) {
        console.error('Error loading fire safety data:', err);
      }
    }

    // Load data when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Set N/A as default for all forms
      setDefaultRadioButtons('fireFormData');
      setDefaultRadioButtons('electricalFormData');
      setDefaultRadioButtons('structuralFormData');
      setDefaultRadioButtons('healthFormData');
      setDefaultRadioButtons('gasFormData');
      setDefaultRadioButtons('boilerFormData');
      setDefaultRadioButtons('consultantFormData');
      setDefaultRadioButtons('dsaFormData');
      setDefaultRadioButtons('emergencyPowerFormData');
      setDefaultRadioButtons('uscSafeFormData');
      setDefaultRadioButtons('safetyTrainingFormData');
      setDefaultRadioButtons('ungpFormData');
      
      // Pre-load latest saved JSON form data for checklist-style forms
      if (window.SafetyAPI) {
        loadFormFromSafetyAPI(SafetyAPI.loadUSCSafe, 'uscSafeFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadHealthHazards, 'healthFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadGasSafety, 'gasFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadBoilerSafety, 'boilerFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadConsultant, 'consultantFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadDSA, 'dsaFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadEmergencyPower, 'emergencyPowerFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadSafetyTraining, 'safetyTrainingFormData');
        loadFormFromSafetyAPI(SafetyAPI.loadUNGP, 'ungpFormData');
      }
      
      loadIncidents();
      loadGrievances();
    });
  </script>
  
  <!-- Safety API Client Scripts -->
  <script src="/js/safety-api-client.js"></script>
  <script>
    // showSafetyTabs is called when the global Safety icon is clicked.
    // It restores the horizontal safety ICON bar (Incidents, Grievances, USC‚ÄëSafe, etc.)
    // and wires each icon to open the correct safety tab in the working pane.
    function ensureTopSafetyBar() {
      var header = document.querySelector('.dashboard-header');
      if (!header) return null;
      var bar = document.querySelector('.top-safety-tabs');
      if (!bar) {
        bar = document.createElement('div');
        bar.className = 'top-safety-tabs';
        header.insertAdjacentElement('afterend', bar);
      }
      return bar;
    }

    function showSafetyTabs(initialTab) {
      try {
        // Hide the text-only tabs row to avoid duplication; icons will drive navigation.
        var nav = document.getElementById('tabs-navigation');
        if (nav) nav.style.display = 'none';

        // Update left-side agents to Safety module
        if (window.AgentUI) {
          window.AgentUI.initModuleAgents({
            containerSelector: '#safety-agents-panel',
            moduleId: 'safety'
          });
        }

        var bar = ensureTopSafetyBar();
        if (!bar) return;

        bar.innerHTML = [
          ['incidents','üö®','Incidents'],
          ['grievances','üìã','Grievances'],
          ['usc-safe','üìë','USC-Safe'],
          ['fire','üî•','Fire'],
          ['electrical','‚ö°','Electrical'],
          ['structural','üèóÔ∏è','Structural'],
          ['health','‚öïÔ∏è','Health'],
          ['gas','üßØ','Gas'],
          ['boiler','‚öôÔ∏è','Boiler'],
          ['consultant','üíº','Consultant'],
          ['dsa','üèõÔ∏è','DSA'],
          ['emergency-power','üîå','Emergency'],
          ['audits','üßæ','Audits'],
          ['training','üéì','Training'],
          ['agent','üõ°Ô∏è','Agent']
        ].map(function(row){
          var key=row[0], ico=row[1], label=row[2];
          return '<button class="sm-tab" data-key="'+key+'">'
            + '<div class="sm-icon-box"><div class="sm-ico">'+ico+'</div></div>'
            + '<div class="sm-lbl">'+label+'</div>'
            + '</button>';
        }).join('');

        bar.onclick = function(e){
          var btn = e.target.closest('.sm-tab');
          if (!btn) return;
          e.preventDefault();
          var key = btn.getAttribute('data-key');
          if (!key) return;
          Array.prototype.forEach.call(bar.querySelectorAll('.sm-tab'), function(b){ b.classList.remove('active'); });
          btn.classList.add('active');
          if (key === 'audits' && typeof window.showAuditList === 'function') {
            window.showAuditList();
          } else if (key === 'agent' && typeof window.showSafetyAgent === 'function') {
            window.showSafetyAgent();
          } else if (key === 'training') {
            if (window.mlOpenInWorkingArea && window.mlOpenInWorkingArea('/training.html?embedded=1')) return;
            window.location.href = '/training.html';
          } else if (typeof window.switchTab === 'function') {
            window.switchTab(key);
          }
        };

        var target = initialTab || 'incidents';
        var targetBtn = bar.querySelector('.sm-tab[data-key="'+target+'"]') || bar.querySelector('.sm-tab');
        if (targetBtn) targetBtn.click();
      } catch (e) {
        console.warn('showSafetyTabs failed', e);
      }
    }

    // Accounting sub-tabs (icon bar) when Accounting module is clicked from this page
    function showAccountingTabs() {
      try {
        var bar = ensureTopSafetyBar();
        if (!bar) return;

        // Update left-side agents to Accounting module
        if (window.AgentUI) {
          window.AgentUI.initModuleAgents({
            containerSelector: '#safety-agents-panel',
            moduleId: 'accounting'
          });
        }

        bar.innerHTML = '';
        function openInWorking(url) {
          try {
            var pane = document.querySelector('.working-pane');
            if (!pane) { window.location.href = url.replace('?embedded=1', ''); return; }
            pane.style.display = 'block';
            pane.style.alignItems = 'stretch';
            pane.style.justifyContent = 'flex-start';
            pane.style.padding = '0';
            pane.innerHTML = '<iframe src="'+url+'" style="border:0;width:100%;height:calc(86vh);background:#ffffff"></iframe>';
          } catch (e) {}
        }
        function addTab(emoji, label, href) {
          var btn = document.createElement('button');
          btn.className = 'sm-tab';
          btn.innerHTML = '<div class="sm-icon-box"><div class="sm-ico">'+emoji+'</div></div>'+
                          '<div class="sm-lbl">'+label+'</div>';
          btn.addEventListener('click', function(ev){ ev.preventDefault(); openInWorking(href); });
          bar.appendChild(btn);
        }

        addTab('üì•','Receivable','/accounting/receivables.html?embedded=1');
        addTab('üìÑ','Payable','/accounting/payables.html?embedded=1');
        addTab('‚úÖ','Paid','/accounting/received-paid.html?tab=paid&embedded=1');
        addTab('üìà','Received','/accounting/received-paid.html?tab=received&embedded=1');
        addTab('üè¶','Banks','/accounting/banks.html?embedded=1');
        addTab('üîÅ','Transfer','/accounting/transfer.html?embedded=1');
        addTab('üíµ','Petty Cash','/accounting/petty-cash.html?embedded=1');

        // Default to Receivable
        var first = bar.querySelector('.sm-tab');
        if (first) first.click();
      } catch (e) {
        console.warn('showAccountingTabs (safety page) failed', e);
      }
    }

    // CRM email sub-tabs (icon bar) when CRM module or Email icon are clicked from this page
    function showCRMTabs() {
      try {
        var bar = ensureTopSafetyBar();
        if (!bar) return;

        // Update left-side agents to CRM module
        if (window.AgentUI) {
          window.AgentUI.initModuleAgents({
            containerSelector: '#safety-agents-panel',
            moduleId: 'crm'
          });
        }

        bar.innerHTML = '';
        function openInWorking(url) {
          try {
            var pane = document.querySelector('.working-pane');
            if (!pane) { window.location.href = url.replace('?embedded=1', ''); return; }
            pane.style.display = 'block';
            pane.style.alignItems = 'stretch';
            pane.style.justifyContent = 'flex-start';
            pane.style.padding = '0';
            pane.innerHTML = '<iframe src="'+url+'" style="border:0;width:100%;height:calc(86vh);background:#ffffff"></iframe>';
          } catch (e) {}
        }
        function addTab(id, emoji, label, href) {
          var btn = document.createElement('button');
          btn.className = 'sm-tab';
          btn.setAttribute('data-crm', id);
          btn.innerHTML = '<div class="sm-icon-box"><div class="sm-ico">'+emoji+'</div></div>'+
                          '<div class="sm-lbl">'+label+'</div>';
          btn.addEventListener('click', function(ev){
            ev.preventDefault();
            Array.prototype.forEach.call(bar.querySelectorAll('.sm-tab'), function(b){ b.classList.remove('active'); });
            btn.classList.add('active');
            openInWorking(href);
          });
          bar.appendChild(btn);
        }

        // CRM mailbox views: Inbox, Sent, Drafts; plus Compose
        addTab('inbox','üì•','Inbox','/crm/mailbox.html?embedded=1&folder=Inbox');
        addTab('sent','üì§','Sent','/crm/mailbox.html?embedded=1&folder=Sent');
        addTab('drafts','üìù','Drafts','/crm/mailbox.html?embedded=1&folder=Drafts');
        addTab('compose','‚úâÔ∏è','Compose','/crm/mailbox-compose.html?embedded=1');

        // Default to Inbox
        var first = bar.querySelector('.sm-tab[data-crm="inbox"]') || bar.querySelector('.sm-tab');
        if (first) first.click();
      } catch (e) {
        console.warn('showCRMTabs (safety page) failed', e);
      }
    }
  </script>
</body>
</html>

